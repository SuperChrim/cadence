/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[5],{181:function(e,t,n){"use strict";n.r(t),n.d(t,"CommonUseField",(function(){return ee})),n.d(t,"CreateCase",(function(){return re})),n.d(t,"default",(function(){return re}));var r=n(2),a=n.n(r),s=n(6),c=n(33),o=n.n(c),i=n(46),u=n(64);const l=Object(i.i)({component:i.b}),d=({isLoading:e})=>a.a.createElement(l,{path:"title",componentProps:{idAria:"caseTitle","data-test-subj":"caseTitle",euiFieldProps:{autoFocus:!0,fullWidth:!0,disabled:e}}});d.displayName="TitleComponent";const p=Object(r.memo)(d);var f=n(72),g=n(84);const m="description",b=({isLoading:e})=>{const{draftComment:t,hasIncomingLensState:n,openLensModal:s,clearDraftComment:c}=Object(g.a)(),{setFieldValue:o}=Object(i.k)(),[{title:u,tags:l}]=Object(i.l)({watch:["title","tags"]}),d=Object(r.useRef)();return Object(r.useEffect)((()=>{(null==t?void 0:t.commentId)===m&&d.current&&(o(m,t.comment),t.caseTitle&&o("title",t.caseTitle),t.caseTags&&t.caseTags.length>0&&o("tags",t.caseTags),n?s({editorRef:d.current}):c())}),[c,t,n,s,o]),a.a.createElement(i.e,{path:m,component:f.a,componentProps:{id:m,ref:d,dataTestSubj:"caseDescription",idAria:"caseDescription",isDisabled:e,caseTitle:u,caseTags:l}})};b.displayName="DescriptionComponent";const C=Object(r.memo)(b);var y=n(78);const E=Object(i.i)({component:i.b}),h=({isLoading:e})=>{const{tags:t,isLoading:n}=Object(y.a)(),s=Object(r.useMemo)((()=>t.map((e=>({label:e})))),[t]);return a.a.createElement(E,{path:"tags",componentProps:{idAria:"caseTags","data-test-subj":"caseTags",euiFieldProps:{fullWidth:!0,placeholder:"",disabled:e||n,options:s,noSuggestions:!1}}})};h.displayName="TagsComponent";const O=Object(r.memo)(h);var j=n(3),T=n(85),S=n(86),w=n(80),v=n(87),I=n(47);const A=({connectors:e,isEdit:t,field:n,setErrors:r,hideConnectorServiceNowSir:s=!1})=>{var c;const[{connectorId:o}]=Object(i.l)({watch:["connectorId"]}),{setValue:u}=n;let l=null!==(c=Object(I.a)(o,e))&&void 0!==c?c:null;return l&&s&&l.actionTypeId===j.ConnectorTypes.serviceNowSIR&&(l=null),a.a.createElement(S.a,{connector:l,fields:n.value,isEdit:t,onChange:u})},L=({connectors:e,hideConnectorServiceNowSir:t=!1,isLoading:n,isLoadingConnectors:c})=>{const{getFields:o,setFieldValue:u}=Object(i.k)(),{connector:l}=Object(v.a)(),d=Object(r.useCallback)((()=>{const{fields:e}=o();e.setValue(null)}),[o]),p=Object(r.useMemo)((()=>t&&l.type===j.ConnectorTypes.serviceNowSIR?"none":e.some((e=>e.id===l.id))?l.id:"none"),[l.id,l.type,e,t]);Object(r.useEffect)((()=>u("connectorId",p)),[p,u]);const f=Object(I.c)({config:w.a.connectorId,connectors:e});return a.a.createElement(s.EuiFlexGroup,null,a.a.createElement(s.EuiFlexItem,null,a.a.createElement(i.e,{path:"connectorId",config:f,component:T.a,defaultValue:p,componentProps:{connectors:e,handleChange:d,hideConnectorServiceNowSir:t,dataTestSubj:"caseConnectors",disabled:n||c,idAria:"caseConnectors",isLoading:n||c}})),a.a.createElement(s.EuiFlexItem,null,a.a.createElement(i.e,{path:"fields",component:A,componentProps:{connectors:e,hideConnectorServiceNowSir:t,isEdit:!0}})))};L.displayName="ConnectorComponent";const x=Object(r.memo)(L),F=Object(i.i)({component:i.b}),N=({isLoading:e})=>{const[{syncAlerts:t}]=Object(i.l)({watch:["syncAlerts"]});return a.a.createElement(F,{path:"syncAlerts",componentProps:{idAria:"caseSyncAlerts","data-test-subj":"caseSyncAlerts",label:u.l,euiFieldProps:{disabled:e,label:t?u.n:u.m}}})};N.displayName="SyncAlertsToggleComponent";const k=Object(r.memo)(N),M=o.a.div.attrs((e=>e)).withConfig({displayName:"Container",componentId:"sc-ui4n0f-0"})(["",""],(({big:e,theme:t})=>{var n,r,a,s;return Object(c.css)(["margin-top:",";"],e?null!==(n=null===(r=t.eui)||void 0===r?void 0:r.euiSizeXL)&&void 0!==n?n:"32px":null!==(a=null===(s=t.eui)||void 0===s?void 0:s.euiSize)&&void 0!==a?a:"16px")})),_=o()(s.EuiLoadingSpinner).withConfig({displayName:"MySpinner",componentId:"sc-ui4n0f-1"})(["position:absolute;top:50%;left:50%;z-index:99;"]),R=[],U=a.a.memo((({connectors:e=R,disableAlerts:t=!1,isLoadingConnectors:n=!1,hideConnectorServiceNowSir:c=!1,withSteps:o=!0})=>{const{isSubmitting:l}=Object(i.k)(),d=Object(r.useMemo)((()=>({title:u.h,children:a.a.createElement(a.a.Fragment,null,a.a.createElement(p,{isLoading:l}),a.a.createElement(M,null,a.a.createElement(O,{isLoading:l})),a.a.createElement(M,{big:!0},a.a.createElement(C,{isLoading:l})))})),[l]),f=Object(r.useMemo)((()=>({title:u.j,children:a.a.createElement(M,null,a.a.createElement(k,{isLoading:l}))})),[l]),g=Object(r.useMemo)((()=>({title:u.i,children:a.a.createElement(M,null,a.a.createElement(x,{connectors:e,hideConnectorServiceNowSir:c,isLoadingConnectors:n,isLoading:l}))})),[e,c,n,l]),m=Object(r.useMemo)((()=>[d,...t?[]:[f],g]),[t,d,f,g]);return a.a.createElement(a.a.Fragment,null,l&&a.a.createElement(_,{"data-test-subj":"create-case-loading-spinner",size:"xl"}),o?a.a.createElement(s.EuiSteps,{headingElement:"h2",steps:m,"data-test-subj":"case-creation-form-steps"}):a.a.createElement(a.a.Fragment,null,d.children,!t&&f.children,g.children))}));U.displayName="CreateCaseForm";var P=n(71),H=n(48),D=n(13),G=n(20);const q=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,isLoading:!0,isError:!1};case"FETCH_SUCCESS":return{...e,isLoading:!1,isError:!1};case"FETCH_FAILURE":return{...e,isLoading:!1,isError:!0};default:return e}};var z=n(88),B=n(65),V=n(74),J=n(50);const $={description:"",tags:[],title:"",connectorId:"none",fields:null,syncAlerts:!0},W=({afterCaseCreated:e,caseType:t=j.CaseType.individual,children:n,hideConnectorServiceNowSir:s,onSuccess:c,syncAlertsDefaultValue:o=!0})=>{const{connectors:u,loading:l}=Object(B.a)(),d=Object(J.a)(),{postCase:p}=(()=>{const[e,t]=Object(r.useReducer)(q,{isLoading:!1,isError:!1}),n=Object(G.f)(),a=Object(r.useRef)(!1),s=Object(r.useRef)(new AbortController),c=Object(r.useCallback)((async e=>{try{a.current=!1,s.current.abort(),s.current=new AbortController,t({type:"FETCH_INIT"});const n=await Object(H.o)(e,s.current.signal);return a.current||t({type:"FETCH_SUCCESS"}),n}catch(e){a.current||("AbortError"!==e.name&&n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:D.d}),t({type:"FETCH_FAILURE"}))}}),[]);return Object(r.useEffect)((()=>()=>{a.current=!0,s.current.abort()}),[]),{...e,postCase:c}})(),{postComment:f}=Object(V.a)(),{pushCaseToExternalService:g}=Object(z.a)(),m=Object(r.useCallback)((async({connectorId:n,fields:r,syncAlerts:a=o,...s},i)=>{if(i){const o=Object(I.a)(n,u),i=o?Object(P.b)(o,r):Object(P.a)(),l=await p({...s,type:t,connector:i,settings:{syncAlerts:a},owner:d[0]});e&&l&&await e(l,f),null!=l&&l.id&&"none"!==n&&await g({caseId:l.id,connector:i}),c&&l&&await c(l)}}),[u,p,t,d,e,c,f,g,o]),{form:b}=Object(i.j)({defaultValue:$,options:{stripEmptyFields:!1},schema:w.a,onSubmit:m}),C=Object(r.useMemo)((()=>null!=n?a.a.Children.map(n,(e=>a.a.cloneElement(e,{connectors:u,isLoadingConnectors:l}))):null),[n,u,l]);return a.a.createElement(i.c,{onKeyDown:e=>{"Enter"===e.key&&e.stopPropagation()},form:b},C)};W.displayName="FormContext";const X=()=>{const{submit:e,isSubmitting:t}=Object(i.k)();return a.a.createElement(s.EuiButton,{"data-test-subj":"create-case-submit",fill:!0,iconType:"plusInCircle",isDisabled:t,isLoading:t,onClick:e},u.c)},K=Object(r.memo)(X);var Y=n(83),Q=n(89),Z=n(23);const ee=Object(i.i)({component:i.b}),te=o.a.div.withConfig({displayName:"Container",componentId:"sc-1pax6s1-0"})(["",""],(({theme:e})=>`\n    margin-top: ${e.eui.euiSize};\n  `)),ne=({afterCaseCreated:e,caseType:t,hideConnectorServiceNowSir:n,disableAlerts:r,onCancel:c,onSuccess:o,timelineIntegration:i,withSteps:l})=>a.a.createElement(Y.b,{timelineIntegration:i},a.a.createElement(W,{afterCaseCreated:e,caseType:t,hideConnectorServiceNowSir:n,onSuccess:o,syncAlertsDefaultValue:!r},a.a.createElement(U,{hideConnectorServiceNowSir:n,disableAlerts:r,withSteps:l}),a.a.createElement(te,null,a.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement(s.EuiButtonEmpty,{"data-test-subj":"create-case-cancel",iconType:"cross",onClick:c,size:"s"},u.a)),a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement(K,null)))),a.a.createElement(Q.a,{fieldName:m}))),re=a.a.memo((e=>a.a.createElement(Z.b,{owner:e.owner},a.a.createElement(ne,e))))},47:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l}));var r=n(3),a=n(51),s=n(49);const c=(e,t)=>{var n;return null!==(n=t.find((t=>t.id===e)))&&void 0!==n?n:null},o={[r.ConnectorTypes.swimlane]:a.a,[r.ConnectorTypes.serviceNowITSM]:s.a,[r.ConnectorTypes.serviceNowSIR]:s.a},i=({connectors:e=[],config:t={}})=>({...t,validations:[{validator:({value:t})=>{const n=c(t,e);var r;if(null!=n)return null===(r=o[n.actionTypeId])||void 0===r?void 0:r.call(o,n)}}]}),u=(e,t)=>{if(null==t)return"";try{if(e.actionTypeRegistry.has(t))return e.actionTypeRegistry.get(t).iconClass}catch{return""}return""},l=e=>null!=e&&((".servicenow"===e.actionTypeId||".servicenow-sir"===e.actionTypeId)&&!!e.config.usesTableApi)},48:function(e,t,n){"use strict";n.d(t,"r",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"o",(function(){return C})),n.d(t,"k",(function(){return y})),n.d(t,"n",(function(){return E})),n.d(t,"l",(function(){return h})),n.d(t,"p",(function(){return O})),n.d(t,"m",(function(){return j})),n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return S})),n.d(t,"q",(function(){return w})),n.d(t,"c",(function(){return v}));var r=n(9),a=n(3),s=n(22),c=n(20),o=n(55),i=n(24);const u=async(e,t=!0,n)=>{const r=await c.a.get().http.fetch(Object(a.getCaseDetailsUrl)(e)+"/resolve",{method:"GET",query:{includeComments:t},signal:n});return Object(i.c)(Object(i.g)(r))},l=async(e,t,n=!0,s)=>{var o,u;const[l,d]=await Promise.all([c.a.get().http.fetch(Object(a.getCaseDetailsUrl)(e),{method:"GET",query:{includeComments:!1},signal:s}),c.a.get().http.fetch(Object(a.getSubCaseDetailsUrl)(e,t),{method:"GET",query:{includeComments:n},signal:s})]),p=Object(r.assign)(l,d),f=null!==(o=null===(u=p.subCaseIds)||void 0===u?void 0:u.findIndex((e=>e===p.id)))&&void 0!==o?o:-1;return p.title=`${p.title}${f>=0?` ${f+1}`:""}`,Object(i.c)(Object(i.h)(p))},d=async(e,t)=>{const n=await c.a.get().http.fetch(a.CASE_STATUS_URL,{method:"GET",signal:e,query:{...t.length>0?{owner:t}:{}}});return Object(i.c)(Object(i.l)(n))},p=async(e,t)=>{const n=await c.a.get().http.fetch(a.CASE_TAGS_URL,{method:"GET",signal:e,query:{...t.length>0?{owner:t}:{}}});return null!=n?n:[]},f=async(e,t)=>{const n=await c.a.get().http.fetch(a.CASE_REPORTERS_URL,{method:"GET",signal:e,query:{...t.length>0?{owner:t}:{}}});return null!=n?n:[]},g=async(e,t)=>{const n=await c.a.get().http.fetch(Object(a.getCaseUserActionUrl)(e),{method:"GET",signal:t});return Object(i.b)(Object(i.i)(n))},m=async(e,t,n)=>{const r=await c.a.get().http.fetch(Object(a.getSubCaseUserActionUrl)(e,t),{method:"GET",signal:n});return Object(i.b)(Object(i.i)(r))},b=async({filterOptions:e={onlyCollectionType:!1,search:"",reporters:[],status:a.StatusAll,tags:[],owner:[]},queryParams:t={page:1,perPage:20,sortField:o.a.createdAt,sortOrder:"desc"},signal:n})=>{const s={reporters:e.reporters.map((e=>{var t;return null!==(t=e.username)&&void 0!==t?t:""})).filter((e=>""!==e)),tags:e.tags,status:e.status,...e.search.length>0?{search:e.search}:{},...e.onlyCollectionType?{type:a.CaseType.collection}:{},...e.owner.length>0?{owner:e.owner}:{},...t},u=await c.a.get().http.fetch(`${a.CASES_URL}/_find`,{method:"GET",query:s.status===a.StatusAll?Object(r.omit)(s,["status"]):s,signal:n});return Object(i.a)(Object(i.j)(u))},C=async(e,t)=>{const n=await c.a.get().http.fetch(a.CASES_URL,{method:"POST",body:JSON.stringify(e),signal:t});return Object(i.c)(Object(i.h)(n))},y=async(e,t,n,r)=>{const s=await c.a.get().http.fetch(a.CASES_URL,{method:"PATCH",body:JSON.stringify({cases:[{...t,id:e,version:n}]}),signal:r});return Object(i.c)(Object(i.k)(s))},E=async(e,t,n,s,o)=>{const u=await c.a.get().http.fetch(a.SUB_CASE_DETAILS_URL,{method:"PATCH",body:JSON.stringify({cases:[{...n,id:e,version:s}]}),signal:o}),l=await c.a.get().http.fetch(Object(a.getCaseDetailsUrl)(e),{method:"GET",query:{includeComments:!1},signal:o}),d=u.map((e=>Object(r.assign)(l,e)));return Object(i.c)(Object(i.k)(d))},h=async(e,t)=>{const n=await c.a.get().http.fetch(a.CASES_URL,{method:"PATCH",body:JSON.stringify({cases:e}),signal:t});return Object(i.c)(Object(i.k)(n))},O=async(e,t,n,r)=>{const s=await c.a.get().http.fetch(`${a.CASES_URL}/${t}/comments`,{method:"POST",body:JSON.stringify(e),...r?{query:{subCaseId:r}}:{},signal:n});return Object(i.c)(Object(i.h)(s))},j=async({caseId:e,commentId:t,commentUpdate:n,version:r,signal:s,owner:o,subCaseId:u})=>{const l=await c.a.get().http.fetch(Object(a.getCaseCommentsUrl)(e),{method:"PATCH",body:JSON.stringify({comment:n,type:a.CommentType.user,id:t,version:r,owner:o}),...u?{query:{subCaseId:u}}:{},signal:s});return Object(i.c)(Object(i.h)(l))},T=async(e,t)=>await c.a.get().http.fetch(a.CASES_URL,{method:"DELETE",query:{ids:JSON.stringify(e)},signal:t}),S=async(e,t)=>await c.a.get().http.fetch(a.SUB_CASES_PATCH_DEL_URL,{method:"DELETE",query:{ids:JSON.stringify(e)},signal:t}),w=async(e,t,n)=>{const r=await c.a.get().http.fetch(Object(a.getCasePushUrl)(e,t),{method:"POST",body:JSON.stringify({}),signal:n});return Object(i.c)(Object(i.h)(r))},v=async e=>{const t=await c.a.get().http.fetch(Object(s.a)(),{method:"GET",signal:e});return Object(i.b)(t)}},49:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>{const{config:{usesTableApi:t}}=e;if(t)return{message:"Deprecated connector"}}},50:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),a=n(23);const s=()=>{const e=Object(r.useContext)(a.a);if(0===e.length)throw new Error("useOwnerContext must be used within an OwnerProvider and not be an empty array");return e}},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(3);const a=["caseIdConfig","caseNameConfig","descriptionConfig","commentsConfig"],s=e=>{const{config:{mappings:t,connectorType:n}}=e;if(n===r.SwimlaneConnectorType.Alerts||(s=t,a.some((e=>null==(null==s?void 0:s[e])))))return{message:"Invalid connector"};var s}},52:function(e,t,n){"use strict";n.d(t,"r",(function(){return s})),n.d(t,"p",(function(){return c})),n.d(t,"q",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"o",(function(){return m})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return C})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return E})),n.d(t,"n",(function(){return h})),n.d(t,"v",(function(){return O})),n.d(t,"u",(function(){return j})),n.d(t,"i",(function(){return T})),n.d(t,"h",(function(){return S}));var r=n(1),a=n(12);n.d(t,"s",(function(){return a.u})),n.d(t,"t",(function(){return a.z}));const s=r.i18n.translate("xpack.cases.configureCases.incidentManagementSystemTitle",{defaultMessage:"External incident management system"}),c=r.i18n.translate("xpack.cases.configureCases.incidentManagementSystemDesc",{defaultMessage:"Connect your cases to an external incident management system. You can then push case data as an incident in a third-party system."}),o=r.i18n.translate("xpack.cases.configureCases.incidentManagementSystemLabel",{defaultMessage:"Incident management system"}),i=r.i18n.translate("xpack.cases.configureCases.addNewConnector",{defaultMessage:"Add new connector"}),u=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsTitle",{defaultMessage:"Case closures"}),l=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsDesc",{defaultMessage:"Define how to close your cases. Automatic closures require an established connection to an external incident management system."}),d=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsSubCases",{defaultMessage:"Automatic closure of sub-cases is not supported."}),p=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsLabel",{defaultMessage:"Case closure options"}),f=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsManual",{defaultMessage:"Manually close cases"}),g=r.i18n.translate("xpack.cases.configureCases.caseClosureOptionsNewIncident",{defaultMessage:"Automatically close cases when pushing new incident to external system"}),m=e=>r.i18n.translate("xpack.cases.configureCases.fieldMappingTitle",{values:{thirdPartyName:e},defaultMessage:"{ thirdPartyName } field mappings"}),b=e=>r.i18n.translate("xpack.cases.configureCases.fieldMappingDesc",{values:{thirdPartyName:e},defaultMessage:"Map Case fields to { thirdPartyName } fields when pushing data to { thirdPartyName }. Field mappings require an established connection to { thirdPartyName }."}),C=e=>r.i18n.translate("xpack.cases.configureCases.fieldMappingDescErr",{values:{thirdPartyName:e},defaultMessage:"Failed to retrieve mappings for { thirdPartyName }."}),y=r.i18n.translate("xpack.cases.configureCases.fieldMappingFirstCol",{defaultMessage:"Kibana case field"}),E=e=>r.i18n.translate("xpack.cases.configureCases.fieldMappingSecondCol",{values:{thirdPartyName:e},defaultMessage:"{ thirdPartyName } field"}),h=r.i18n.translate("xpack.cases.configureCases.fieldMappingThirdCol",{defaultMessage:"On edit and update"}),O=(r.i18n.translate("xpack.cases.configureCases.fieldMappingEditAppend",{defaultMessage:"Append"}),r.i18n.translate("xpack.cases.configureCases.cancelButton",{defaultMessage:"Cancel"}),r.i18n.translate("xpack.cases.configureCases.saveButton",{defaultMessage:"Save"}),r.i18n.translate("xpack.cases.configureCases.saveAndCloseButton",{defaultMessage:"Save & close"}),r.i18n.translate("xpack.cases.configureCases.warningTitle",{defaultMessage:"Warning"})),j=(r.i18n.translate("xpack.cases.configureCases.commentMapping",{defaultMessage:"Comments"}),r.i18n.translate("xpack.cases.configureCases.updateConnector",{defaultMessage:"Update field mappings"}),e=>r.i18n.translate("xpack.cases.configureCases.updateSelectedConnector",{values:{connectorName:e},defaultMessage:"Update { connectorName }"})),T=r.i18n.translate("xpack.cases.configureCases.deprecatedTooltipText",{defaultMessage:"deprecated"}),S=r.i18n.translate("xpack.cases.configureCases.deprecatedTooltipContent",{defaultMessage:"This connector is deprecated. Update it, or create a new one."})},55:function(e,t,n){"use strict";n.d(t,"b",(function(){return r.b})),n.d(t,"a",(function(){return r.a}));var r=n(25)},59:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n(21),a=n(22),s=n(3),c=n(20),o=n(24);const i=async({signal:e})=>await c.a.get().http.fetch(`${s.CASE_CONFIGURE_CONNECTORS_URL}/_find`,{method:"GET",signal:e}),u=async({signal:e,owner:t})=>{const n=await c.a.get().http.fetch(s.CASE_CONFIGURE_URL,{method:"GET",signal:e,query:{...t.length>0?{owner:t}:{}}});if(!Object(r.isEmpty)(n)){const e=Object(o.e)(n);if(Array.isArray(e)&&e.length>0)return Object(o.c)(e[0])}return null},l=async(e,t)=>{const n=await c.a.get().http.fetch(s.CASE_CONFIGURE_URL,{method:"POST",body:JSON.stringify(e),signal:t});return Object(o.c)(Object(o.f)(n))},d=async(e,t,n)=>{const r=await c.a.get().http.fetch(Object(s.getCaseConfigurationDetailsUrl)(e),{method:"PATCH",body:JSON.stringify(t),signal:n});return Object(o.c)(Object(o.f)(r))},p=async({signal:e})=>{const t=await c.a.get().http.fetch(Object(a.a)(),{method:"GET",signal:e});return Object(o.b)(t)}},62:function(e,t,n){e.exports=n(28)(1074)},63:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(1),a=n(13);n.d(t,"a",(function(){return a.d}));const s=r.i18n.translate("xpack.cases.configure.successSaveToast",{defaultMessage:"Saved external connection settings"}),c=r.i18n.translate("xpack.cases.configure.readPermissionsErrorDescription",{defaultMessage:"You do not have permissions to view connectors. If you would like to view the connectors associated with this case, contact your Kibana administrator."})},64:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return o})),n.d(t,"l",(function(){return i}));var r=n(1),a=n(12);n.d(t,"a",(function(){return a.f})),n.d(t,"b",(function(){return a.n})),n.d(t,"c",(function(){return a.o})),n.d(t,"d",(function(){return a.r})),n.d(t,"e",(function(){return a.s})),n.d(t,"f",(function(){return a.x})),n.d(t,"g",(function(){return a.y})),n.d(t,"k",(function(){return a.P})),n.d(t,"m",(function(){return a.Q})),n.d(t,"n",(function(){return a.R})),n.d(t,"o",(function(){return a.S})),n.d(t,"p",(function(){return a.T})),n.d(t,"q",(function(){return a.U})),n.d(t,"r",(function(){return a.V}));const s=r.i18n.translate("xpack.cases.create.stepOneTitle",{defaultMessage:"Case fields"}),c=r.i18n.translate("xpack.cases.create.stepTwoTitle",{defaultMessage:"Case settings"}),o=r.i18n.translate("xpack.cases.create.stepThreeTitle",{defaultMessage:"External Connector Fields"}),i=r.i18n.translate("xpack.cases.create.syncAlertsLabel",{defaultMessage:"Sync alert status with case status"})},65:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),a=n(59),s=n(20),c=n(63);const o=({toastPermissionsErrors:e=!0}={})=>{const t=Object(s.f)(),[n,o]=Object(r.useState)({loading:!0,connectors:[]}),i=Object(r.useRef)(!1),u=Object(r.useRef)(new AbortController),l=Object(r.useCallback)((async()=>{try{i.current=!1,u.current.abort(),u.current=new AbortController,o({...n,loading:!0});const e=await Object(a.b)({signal:u.current.signal});i.current||o({loading:!1,connectors:e})}catch(n){if(!i.current){let a;var r,s;if("AbortError"!==n.name)403!==(null===(r=n.body)||void 0===r?void 0:r.statusCode)&&401!==(null===(s=n.body)||void 0===s?void 0:s.statusCode)||(a=c.b),(void 0===a||e)&&t.addError(n.body&&n.body.message?new Error(n.body.message):n,{title:c.a});o({loading:!1,connectors:[],permissionsError:a})}}}),[]);return Object(r.useEffect)((()=>(l(),()=>{i.current=!0,u.current.abort()})),[]),{loading:n.loading,connectors:n.connectors,refetchConnectors:l,permissionsError:n.permissionsError}}},70:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(2),a=n.n(r),s=n(6),c=n(33),o=n.n(c),i=n(3),u=n(52),l=n(20),d=n(47),p=n(37);const f=o()(s.EuiIcon).withConfig({displayName:"EuiIconExtended",componentId:"sc-12z1pzb-0"})(["margin-right:13px;margin-bottom:0 !important;"]),g={value:"none",inputDisplay:a.a.createElement(s.EuiFlexGroup,{gutterSize:"none",alignItems:"center",responsive:!1},a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement(f,{type:"minusInCircle",size:"m"})),a.a.createElement(s.EuiFlexItem,null,a.a.createElement("span",{"data-test-subj":"dropdown-connector-no-connector"},u.t))),"data-test-subj":"dropdown-connector-no-connector"},m={value:"add-connector",inputDisplay:a.a.createElement("span",{className:"euiButtonEmpty euiButtonEmpty--primary euiButtonEmpty--xSmall euiButtonEmpty--flushLeft"},u.a),"data-test-subj":"dropdown-connector-add-connector"},b=Object(p.euiStyled)(s.EuiIconTip)`
  margin-left: ${({theme:e})=>e.eui.euiSizeS}
  margin-bottom: 0 !important;
`,C=({connectors:e,disabled:t,isLoading:n,onChange:c,selectedConnector:o,appendAddConnectorButton:p=!1,hideConnectorServiceNowSir:C=!1})=>{const{triggersActionsUi:y}=Object(l.d)().services,E=Object(r.useMemo)((()=>{const t=e.reduce(((e,t)=>C&&t.actionTypeId===i.ConnectorTypes.serviceNowSIR?e:[...e,{value:t.id,inputDisplay:a.a.createElement(s.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement(f,{type:Object(d.b)(y,t.actionTypeId),size:"m"})),a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement("span",null,t.name,Object(d.d)(t)&&` (${u.i})`)),Object(d.d)(t)&&a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement(b,{"aria-label":u.h,size:"m",type:"alert",color:"warning",content:u.h}))),"data-test-subj":`dropdown-connector-${t.id}`}]),[g]);return p?[...t,m]:t}),[e]);return a.a.createElement(s.EuiSuperSelect,{"aria-label":u.q,"data-test-subj":"dropdown-connectors",disabled:t,fullWidth:!0,isLoading:n,onChange:c,options:E,valueOfSelected:o})},y=a.a.memo(C)},71:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(3);const a=()=>({id:"none",name:"none",type:r.ConnectorTypes.none,fields:null}),s=(e,t=null)=>{const n={type:e.actionTypeId,fields:t};return{id:e.id,name:e.name,...n}},c=(e,t)=>{var n;return null!==(n=e.find((e=>e.id===t.id)))&&void 0!==n?n:null}},74:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),a=n(48),s=n(13),c=n(20);const o=(e,t)=>{switch(t.type){case"FETCH_INIT":return{isLoading:!0,isError:!1};case"FETCH_SUCCESS":return{isLoading:!1,isError:!1};case"FETCH_FAILURE":return{isLoading:!1,isError:!0};default:return e}},i=()=>{const[e,t]=Object(r.useReducer)(o,{isLoading:!1,isError:!1}),n=Object(c.f)(),i=Object(r.useRef)(!1),u=Object(r.useRef)(new AbortController),l=Object(r.useCallback)((async({caseId:e,data:r,updateCase:c,subCaseId:o})=>{try{i.current=!1,u.current.abort(),u.current=new AbortController,t({type:"FETCH_INIT"});const n=await Object(a.p)(r,e,u.current.signal,o);i.current||(t({type:"FETCH_SUCCESS"}),c&&c(n))}catch(e){i.current||("AbortError"!==e.name&&n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.d}),t({type:"FETCH_FAILURE"}))}}),[n]);return Object(r.useEffect)((()=>()=>{i.current=!0,u.current.abort()}),[]),{...e,postComment:l}}},78:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),a=n(20),s=n(50),c=n(48),o=n(13);const i=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,isLoading:!0,isError:!1};case"FETCH_SUCCESS":return{...e,isLoading:!1,isError:!1,tags:t.payload};case"FETCH_FAILURE":return{...e,isLoading:!1,isError:!0};default:return e}},u=[],l=()=>{const e=Object(s.a)(),[t,n]=Object(r.useReducer)(i,{isLoading:!0,isError:!1,tags:u}),l=Object(a.f)(),d=Object(r.useRef)(!1),p=Object(r.useRef)(new AbortController),f=Object(r.useCallback)((async()=>{try{d.current=!1,p.current.abort(),p.current=new AbortController,n({type:"FETCH_INIT"});const t=await Object(c.j)(p.current.signal,e);d.current||n({type:"FETCH_SUCCESS",payload:t})}catch(e){d.current||("AbortError"!==e.name&&l.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:o.d}),n({type:"FETCH_FAILURE"}))}}),[]);return Object(r.useEffect)((()=>(f(),()=>{d.current=!0,p.current.abort()})),[]),{...t,fetchTags:f}}},80:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return g}));var r=n(3),a=n(46),s=n(64),c=n(6),o=n(2),i=n.n(o),u=n(12);const l=i.a.createElement(c.EuiText,{color:"subdued",size:"xs","data-test-subj":"form-optional-field-label"},u.G),{emptyField:d,maxLengthField:p}=a.g,f={type:a.a.COMBO_BOX,label:s.o,helpText:s.q,labelAppend:l,validations:[{validator:d(s.p),type:a.f.ARRAY_ITEM,isBlocking:!1}]},g={title:{type:a.a.TEXT,label:s.g,validations:[{validator:d(s.r)},{validator:p({length:r.MAX_TITLE_LENGTH,message:s.f("title",r.MAX_TITLE_LENGTH)})}]},description:{label:s.d,validations:[{validator:d(s.e)}]},tags:f,connectorId:{type:a.a.SUPER_SELECT,label:s.b,defaultValue:"none"},fields:{defaultValue:null},syncAlerts:{helpText:s.k,type:a.a.TOGGLE,defaultValue:!0}}},85:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(2),a=n.n(r),s=n(21),c=n(6),o=n(33),i=n.n(o),u=n(46),l=n(70);const d=i()(c.EuiFormRow).withConfig({displayName:"EuiFormRowWrapper",componentId:"sc-1yy69el-0"})([".euiFormErrorText{display:none;}"]),p=({connectors:e,dataTestSubj:t,disabled:n=!1,field:c,idAria:o,isEdit:i=!0,isLoading:p=!1,handleChange:f,hideConnectorServiceNowSir:g=!1})=>{const{isInvalid:m,errorMessage:b}=Object(u.h)(c),C=Object(r.useCallback)((e=>{f&&f(e),c.setValue(e)}),[f,c]);return i?a.a.createElement(d,{"data-test-subj":t,describedByIds:o?[o]:void 0,error:b,fullWidth:!0,helpText:c.helpText,isInvalid:m,label:c.label,labelAppend:c.labelAppend},a.a.createElement(l.a,{connectors:e,disabled:n,hideConnectorServiceNowSir:g,isLoading:p,onChange:C,selectedConnector:Object(s.isEmpty)(c.value)?"none":c.value})):null}},86:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),a=n.n(r),s=n(6),c=n(26);const o=({connector:e,isEdit:t,onChange:n,fields:o})=>{const{caseConnectorsRegistry:i}=Object(c.b)();if(null==e||null==e.actionTypeId||".none"===e.actionTypeId)return null;const{fieldsComponent:u}=i.get(e.actionTypeId);return a.a.createElement(a.a.Fragment,null,null!=u?a.a.createElement(r.Suspense,{fallback:a.a.createElement(s.EuiFlexGroup,{justifyContent:"center"},a.a.createElement(s.EuiFlexItem,{grow:!1},a.a.createElement(s.EuiLoadingSpinner,{size:"m"})))},a.a.createElement("div",{"data-test-subj":"connector-fields"},a.a.createElement(u,{isEdit:t,fields:o,connector:e,onChange:n}))):null)},i=Object(r.memo)(o)},87:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),a=n(59),s=n(63),c=n(3),o=n(20),i=n(50);const u=(e,t)=>{switch(t.type){case"setLoading":return{...e,loading:t.payload};case"setFirstLoad":return{...e,firstLoad:t.payload};case"setPersistLoading":return{...e,persistLoading:t.payload};case"setVersion":return{...e,version:t.payload};case"setID":return{...e,id:t.payload};case"setCurrentConfiguration":return{...e,currentConfiguration:{...t.currentConfiguration}};case"setConnector":return{...e,connector:t.connector};case"setClosureType":return{...e,closureType:t.closureType};case"setMappings":return{...e,mappings:t.mappings};default:return e}},l={closureType:"close-by-user",connector:{fields:null,id:"none",name:"none",type:c.ConnectorTypes.none},currentConfiguration:{closureType:"close-by-user",connector:{fields:null,id:"none",name:"none",type:c.ConnectorTypes.none}},firstLoad:!1,loading:!0,mappings:[],persistLoading:!1,version:"",id:""},d=()=>{const e=Object(i.a)(),[t,n]=Object(r.useReducer)(u,l),c=Object(o.f)(),d=Object(r.useCallback)((e=>{n({currentConfiguration:e,type:"setCurrentConfiguration"})}),[]),p=Object(r.useCallback)((e=>{n({connector:e,type:"setConnector"})}),[]),f=Object(r.useCallback)((e=>{n({closureType:e,type:"setClosureType"})}),[]),g=Object(r.useCallback)((e=>{n({mappings:e,type:"setMappings"})}),[]),m=Object(r.useCallback)((e=>{n({payload:e,type:"setLoading"})}),[]),b=Object(r.useCallback)((e=>{n({payload:e,type:"setFirstLoad"})}),[]),C=Object(r.useCallback)((e=>{n({payload:e,type:"setPersistLoading"})}),[]),y=Object(r.useCallback)((e=>{n({payload:e,type:"setVersion"})}),[]),E=Object(r.useCallback)((e=>{n({payload:e,type:"setID"})}),[]),h=Object(r.useRef)(!1),O=Object(r.useRef)(new AbortController),j=Object(r.useRef)(!1),T=Object(r.useRef)(new AbortController),S=Object(r.useCallback)((async()=>{try{h.current=!1,O.current.abort(),O.current=new AbortController,m(!0);const n=await Object(a.c)({signal:O.current.signal,owner:e});h.current||(null!=n&&(p(n.connector),null!=f&&f(n.closureType),y(n.version),E(n.id),g(n.mappings),t.firstLoad||(b(!0),null!=d&&d({closureType:n.closureType,connector:{...n.connector}})),null!=n.error&&c.addError(new Error(n.error),{title:s.a})),m(!1))}catch(e){h.current||("AbortError"!==e.name&&c.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.a}),m(!1))}}),[t.firstLoad]),w=Object(r.useCallback)((async({connector:n,closureType:r})=>{try{j.current=!1,T.current.abort(),T.current=new AbortController,C(!0);const o={connector:n,closure_type:r},i=0===t.version.length?await Object(a.e)({...o,owner:e[0]},T.current.signal):await Object(a.d)(t.id,{...o,version:t.version},T.current.signal);j.current||(p(i.connector),f&&f(i.closureType),y(i.version),E(i.id),g(i.mappings),null!=d&&d({closureType:i.closureType,connector:{...i.connector}}),null!=i.error&&c.addError(new Error(i.error),{title:s.a}),c.addSuccess(s.c),C(!1))}catch(e){j.current||("AbortError"!==e.name&&c.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.a}),p(t.currentConfiguration.connector),C(!1))}}),[C,t.version,t.id,t.currentConfiguration.connector,e,p,f,y,E,g,d,c]);return Object(r.useEffect)((()=>(S(),()=>{h.current=!0,O.current.abort(),j.current=!0,T.current.abort()})),[]),{...t,refetchCaseConfigure:S,persistCaseConfigure:w,setCurrentConfiguration:d,setConnector:p,setClosureType:f,setMappings:g}}},88:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),a=n(48),s=n(13),c=n(20);const o=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,isLoading:!0,isError:!1};case"FETCH_SUCCESS":return{...e,isLoading:!1,isError:!1};case"FETCH_FAILURE":return{...e,isLoading:!1,isError:!0};default:return e}},i=()=>{const[e,t]=Object(r.useReducer)(o,{isLoading:!1,isError:!1}),n=Object(c.f)(),i=Object(r.useRef)(!1),u=Object(r.useRef)(new AbortController),l=Object(r.useCallback)((async({caseId:e,connector:r})=>{try{u.current.abort(),i.current=!1,u.current=new AbortController,t({type:"FETCH_INIT"});const c=await Object(a.q)(e,r.id,u.current.signal);return i.current||(t({type:"FETCH_SUCCESS"}),n.addSuccess(s.h(r.name))),c}catch(e){i.current||("AbortError"!==e.name&&n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.d}),t({type:"FETCH_FAILURE"}))}}),[]);return Object(r.useEffect)((()=>()=>{u.current.abort(),i.current=!0}),[]),{...e,pushCaseToExternalService:l}}},89:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),a=n(46),s=n(79);const c=({fieldName:e})=>{var t,n;const{setFieldValue:c,getFormData:o}=Object(a.k)(),i=null===(t=Object(s.a)())||void 0===t?void 0:t.hooks,u=o(),l=Object(r.useCallback)((t=>c(e,t)),[e,c]);return null==i||i.useInsertTimeline(null!==(n=u[e])&&void 0!==n?n:"",l),null}}}]);