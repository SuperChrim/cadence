/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[12],{100:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=t.TIMESTAMP=t.TAGS=t.SPACE_IDS=t.KIBANA_NAMESPACE=t.EVENT_KIND=t.EVENT_ACTION=t.ECS_VERSION=t.CONSUMERS=t.ALERT_WORKFLOW_USER=t.ALERT_WORKFLOW_STATUS=t.ALERT_WORKFLOW_REASON=t.ALERT_UUID=t.ALERT_SYSTEM_STATUS=t.ALERT_STATUS=t.ALERT_START=t.ALERT_SEVERITY=t.ALERT_RULE_VERSION=t.ALERT_RULE_UUID=t.ALERT_RULE_UPDATED_BY=t.ALERT_RULE_UPDATED_AT=t.ALERT_RULE_TYPE_ID=t.ALERT_RULE_TYPE=t.ALERT_RULE_TO=t.ALERT_RULE_TAGS=t.ALERT_RULE_SEVERITY_MAPPING=t.ALERT_RULE_SEVERITY=t.ALERT_RULE_RULE_NAME_OVERRIDE=t.ALERT_RULE_RULE_ID=t.ALERT_RULE_RISK_SCORE_MAPPING=t.ALERT_RULE_RISK_SCORE=t.ALERT_RULE_REFERENCES=t.ALERT_RULE_PRODUCER=t.ALERT_RULE_PARAMS=t.ALERT_RULE_NOTE=t.ALERT_RULE_NAMESPACE=t.ALERT_RULE_NAME=t.ALERT_RULE_LICENSE=t.ALERT_RULE_INTERVAL=t.ALERT_RULE_FROM=t.ALERT_RULE_ENABLED=t.ALERT_RULE_DESCRIPTION=t.ALERT_RULE_CREATED_BY=t.ALERT_RULE_CREATED_AT=t.ALERT_RULE_CONSUMER=t.ALERT_RULE_CATEGORY=t.ALERT_RULE_AUTHOR=t.ALERT_RISK_SCORE=t.ALERT_REASON=t.ALERT_NAMESPACE=t.ALERT_INSTANCE_ID=t.ALERT_EVALUATION_VALUE=t.ALERT_EVALUATION_THRESHOLD=t.ALERT_END=t.ALERT_DURATION=t.ALERT_ACTION_GROUP=void 0;const r="kibana";t.KIBANA_NAMESPACE=r;const n="kibana.alert";t.ALERT_NAMESPACE=n;const l="kibana.alert.rule";t.ALERT_RULE_NAMESPACE=l;const i="kibana.consumers";t.CONSUMERS=i;const o="ecs.version";t.ECS_VERSION=o;const s="event.action";t.EVENT_ACTION=s;const c="event.kind";t.EVENT_KIND=c;const u="kibana.space_ids";t.SPACE_IDS=u;const d="tags";t.TAGS=d;const m="@timestamp";t.TIMESTAMP=m;const E="kibana.version";t.VERSION=E;const p="kibana.alert.action_group";t.ALERT_ACTION_GROUP=p;const f="kibana.alert.duration.us";t.ALERT_DURATION=f;const b="kibana.alert.end";t.ALERT_END=b;const h="kibana.alert.evaluation.threshold";t.ALERT_EVALUATION_THRESHOLD=h;const g="kibana.alert.evaluation.value";t.ALERT_EVALUATION_VALUE=g;const R="kibana.alert.instance.id";t.ALERT_INSTANCE_ID=R;const T="kibana.alert.reason";t.ALERT_REASON=T;const _="kibana.alert.risk_score";t.ALERT_RISK_SCORE=_;const A="kibana.alert.severity";t.ALERT_SEVERITY=A;const y="kibana.alert.start";t.ALERT_START=y;const L="kibana.alert.status";t.ALERT_STATUS=L;const O="kibana.alert.system_status";t.ALERT_SYSTEM_STATUS=O;const x="kibana.alert.uuid";t.ALERT_UUID=x;const v="kibana.alert.workflow_reason";t.ALERT_WORKFLOW_REASON=v;const k="kibana.alert.workflow_status";t.ALERT_WORKFLOW_STATUS=k;const S="kibana.alert.workflow_user";t.ALERT_WORKFLOW_USER=S;const C="kibana.alert.rule.author";t.ALERT_RULE_AUTHOR=C;const M="kibana.alert.rule.created_at";t.ALERT_RULE_CREATED_AT=M;const j="kibana.alert.rule.created_by";t.ALERT_RULE_CREATED_BY=j;const U="kibana.alert.rule.description";t.ALERT_RULE_DESCRIPTION=U;const I="kibana.alert.rule.enabled";t.ALERT_RULE_ENABLED=I;const w="kibana.alert.rule.from";t.ALERT_RULE_FROM=w;const F="kibana.alert.rule.interval";t.ALERT_RULE_INTERVAL=F;const N="kibana.alert.rule.license";t.ALERT_RULE_LICENSE=N;const D="kibana.alert.rule.category";t.ALERT_RULE_CATEGORY=D;const P="kibana.alert.rule.name";t.ALERT_RULE_NAME=P;const W="kibana.alert.rule.note";t.ALERT_RULE_NOTE=W;const z="kibana.alert.rule.params";t.ALERT_RULE_PARAMS=z;const V="kibana.alert.rule.references";t.ALERT_RULE_REFERENCES=V;const B="kibana.alert.rule.risk_score";t.ALERT_RULE_RISK_SCORE=B;const G="kibana.alert.rule.risk_score_mapping";t.ALERT_RULE_RISK_SCORE_MAPPING=G;const Q="kibana.alert.rule.rule_id";t.ALERT_RULE_RULE_ID=Q;const Y="kibana.alert.rule.rule_name_override";t.ALERT_RULE_RULE_NAME_OVERRIDE=Y;const $="kibana.alert.rule.severity";t.ALERT_RULE_SEVERITY=$;const q="kibana.alert.rule.severity_mapping";t.ALERT_RULE_SEVERITY_MAPPING=q;const K="kibana.alert.rule.tags";t.ALERT_RULE_TAGS=K;const H="kibana.alert.rule.to";t.ALERT_RULE_TO=H;const X="kibana.alert.rule.type";t.ALERT_RULE_TYPE=X;const J="kibana.alert.rule.rule_type_id";t.ALERT_RULE_TYPE_ID=J;const Z="kibana.alert.rule.updated_at";t.ALERT_RULE_UPDATED_AT=Z;const ee="kibana.alert.rule.updated_by";t.ALERT_RULE_UPDATED_BY=ee;const te="kibana.alert.rule.version";t.ALERT_RULE_VERSION=te;const ae="kibana.alert.rule.consumer";t.ALERT_RULE_CONSUMER=ae;const re="kibana.alert.rule.producer";t.ALERT_RULE_PRODUCER=re;const ne="kibana.alert.rule.uuid";t.ALERT_RULE_UUID=ne},118:function(e,t,a){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},119:function(e,t,a){"use strict";var r="%[a-f0-9]{2}",n=new RegExp(r,"gi"),l=new RegExp("("+r+")+","gi");function i(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var a=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],i(a),i(r))}function o(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(n),a=1;a<t.length;a++)t=(e=i(t,a).join("")).match(n);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},a=l.exec(e);a;){try{t[a[0]]=decodeURIComponent(a[0])}catch(e){var r=o(a[0]);r!==a[0]&&(t[a[0]]=r)}a=l.exec(e)}t["%C2"]="�";for(var n=Object.keys(t),i=0;i<n.length;i++){var s=n[i];e=e.replace(new RegExp(s,"g"),t[s])}return e}(e)}}},120:function(e,t,a){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const a=e.indexOf(t);return-1===a?[e]:[e.slice(0,a),e.slice(a+t.length)]}},123:function(e,t,a){"use strict";a.d(t,"i",(function(){return E})),a.d(t,"d",(function(){return p})),a.d(t,"f",(function(){return f})),a.d(t,"j",(function(){return b})),a.d(t,"k",(function(){return h})),a.d(t,"h",(function(){return g})),a.d(t,"g",(function(){return R})),a.d(t,"a",(function(){return _})),a.d(t,"e",(function(){return A})),a.d(t,"c",(function(){return y})),a.d(t,"b",(function(){return L}));var r=a(1),n=a.n(r),l=a(50),i=a(47),o=a(48),s=a.n(o),c=a(2),u=a(45),d=a(46),m=a(7);const E={headerFormatter:e=>s()(e.value).format("Y-MM-DD HH:mm:ss")},p=20,f={s:c.i18n.translate("xpack.infra.alerts.timeLabels.seconds",{defaultMessage:"seconds"}),m:c.i18n.translate("xpack.infra.alerts.timeLabels.minutes",{defaultMessage:"minutes"}),h:c.i18n.translate("xpack.infra.alerts.timeLabels.hours",{defaultMessage:"hours"}),d:c.i18n.translate("xpack.infra.alerts.timeLabels.days",{defaultMessage:"days"})},b=(e,t)=>Object(r.useMemo)((()=>"number"==typeof e&&"number"==typeof t?Object(l.niceTimeFormatter)([e,t]):e=>`${e}`),[e,t]),h=m.a,g=(e,t=!1)=>{let a=null,r=null;const n=e.reduce(((e,t)=>(t.points.forEach((t=>{const a=e[t.timestamp]||[];e[t.timestamp]=[...a,t.value]})),e)),{});Object.values(n).forEach((e=>{const n=t?Object(i.sum)(e):Object(i.max)(e),l=Object(i.min)(e);n&&(!r||n>r)&&(r=n),l&&(!a||l<a)&&(a=l)}));const l=Object.keys(n).map(Number),o=Object(i.min)(l)||0,s=Object(i.max)(l)||0;return{yMin:a||0,yMax:r||0,xMin:o,xMax:s}},R=e=>e?l.DARK_THEME:l.LIGHT_THEME,T=({children:e})=>n.a.createElement("div",{style:{width:"100%",height:150,display:"flex",justifyContent:"center",alignItems:"center"}},e),_=({children:e})=>n.a.createElement("div",{style:{width:"100%",height:150}},e),A=()=>n.a.createElement(T,null,n.a.createElement(u.EuiText,{color:"subdued","data-test-subj":"noChartData"},n.a.createElement(d.FormattedMessage,{id:"xpack.infra.alerts.charts.noDataMessage",defaultMessage:"No chart data available"}))),y=()=>n.a.createElement(T,null,n.a.createElement(u.EuiText,{color:"subdued","data-test-subj":"loadingData"},n.a.createElement(d.FormattedMessage,{id:"xpack.infra.alerts.charts.loadingMessage",defaultMessage:"Loading"}))),L=()=>n.a.createElement(T,null,n.a.createElement(u.EuiText,{color:"subdued","data-test-subj":"chartErrorState"},n.a.createElement(d.FormattedMessage,{id:"xpack.infra.alerts.charts.errorMessage",defaultMessage:"Uh oh, something went wrong"})))},159:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var r=a(1),n=a.n(r),l=a(47),i=a(50),o=a(97),s=a(79);const c=.3,u=({threshold:e,sortedThresholds:t,comparator:a,color:r,id:u,firstTimestamp:d,lastTimestamp:m,domain:E})=>{if(!a||!e)return null;const p=[o.a.GT,o.a.GT_OR_EQ].includes(a),f=[o.a.LT,o.a.LT_OR_EQ].includes(a);return n.a.createElement(n.a.Fragment,null,n.a.createElement(i.LineAnnotation,{id:`${u}-thresholds`,domainType:i.AnnotationDomainType.YDomain,"data-test-subj":"threshold-line",dataValues:t.map((e=>({dataValue:e}))),style:{line:{strokeWidth:2,stroke:Object(s.b)(r),opacity:1}}}),2===t.length&&a===o.a.BETWEEN?n.a.createElement(n.a.Fragment,null,n.a.createElement(i.RectAnnotation,{id:`${u}-lower-threshold`,"data-test-subj":"between-rect",style:{fill:Object(s.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:Object(l.first)(e),y1:Object(l.last)(e)}}]})):null,2===t.length&&a===o.a.OUTSIDE_RANGE?n.a.createElement(n.a.Fragment,null,n.a.createElement(i.RectAnnotation,{id:`${u}-lower-threshold`,"data-test-subj":"outside-range-lower-rect",style:{fill:Object(s.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:E.min,y1:Object(l.first)(e)}}]}),n.a.createElement(i.RectAnnotation,{id:`${u}-upper-threshold`,"data-test-subj":"outside-range-upper-rect",style:{fill:Object(s.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:Object(l.last)(e),y1:E.max}}]})):null,f&&null!=Object(l.first)(e)?n.a.createElement(i.RectAnnotation,{id:`${u}-upper-threshold`,"data-test-subj":"below-rect",style:{fill:Object(s.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:E.min,y1:Object(l.first)(e)}}]}):null,p&&null!=Object(l.first)(e)?n.a.createElement(i.RectAnnotation,{id:`${u}-upper-threshold`,"data-test-subj":"above-rect",style:{fill:Object(s.b)(r),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:Object(l.first)(e),y1:E.max}}]}):null)}},292:function(e,t,a){"use strict";a.r(t),a.d(t,"QUERY_INVALID",(function(){return H})),a.d(t,"defaultExpression",(function(){return X})),a.d(t,"Expressions",(function(){return J})),a.d(t,"ExpressionRow",(function(){return re})),a.d(t,"nodeTypes",(function(){return ie}));var r=a(47),n=a(1),l=a.n(n),i=a(45),o=a(46),s=a(2),c=a(129),u=a(97),d=a(11),m=a(61),E=a(130),p=a(128),f=a(189),b=a(192),h=a(193),g=a(194),R=a(195),T=a(196),_=a(197),A=a(80),y=a(77),L=a(109),O=a(82);const x={avg:s.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.avg",{defaultMessage:"Average"}),max:s.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.max",{defaultMessage:"Max"}),min:s.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.min",{defaultMessage:"Min"}),rate:s.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.rate",{defaultMessage:"Rate"})},v=O.b.map((e=>({text:x[e],value:e}))),k=({metric:e,metrics:t,customMetric:a,fields:c,errors:u,onChange:d,onChangeCustom:m,popupPosition:E})=>{var p;const[f,b]=Object(n.useState)(!1),[h,g]=Object(n.useState)("custom"===(null==e?void 0:e.value)),[R,T]=Object(n.useState)(null==e?void 0:e.value),[_,A]=Object(n.useState)(null==a?void 0:a.label),y={text:s.i18n.translate("xpack.infra.metrics.alertFlyout.expression.metric.selectFieldLabel",{defaultMessage:"Select a metric"}),value:""},x=Object(n.useMemo)((()=>c.filter((e=>e.aggregatable&&"number"===e.type&&!((null==a?void 0:a.field)===e.name))).map((e=>({label:e.name})))),[c,null==a?void 0:a.field]),k=Object(n.useMemo)((()=>h?(null==a?void 0:a.field)&&Object(L.a)(a):(null==e?void 0:e.text)||y.text),[h,e,a,y]),C=Object(n.useCallback)((e=>{"metric-popover-custom"===e?(g(!0),d("custom")):(g(!1),d(R))}),[g,d,R]),M=Object(n.useCallback)((e=>{const t=e.target.value,r=O.c.is(t)?t:"avg",n={...a,aggregation:r};O.d.is(n)&&m(n)}),[a,m]),j=Object(n.useCallback)((e=>{const t={...a,field:e[0].label};O.d.is(t)&&m(t)}),[a,m]),U=Object(r.debounce)(m,500),I=Object(n.useCallback)((e=>{A(e.target.value);const t={...a,label:e.target.value};O.d.is(t)&&U(t)}),[a,U]),w=t.map((e=>({label:e.text,value:e.value})),[]);return l.a.createElement(i.EuiPopover,{id:"metricPopover",button:l.a.createElement(i.EuiExpression,{description:s.i18n.translate("xpack.infra.metrics.alertFlyout.expression.metric.whenLabel",{defaultMessage:"When"}),value:k,isActive:Boolean(f||u.metric&&u.metric.length>0),onClick:()=>{b(!0)},color:null!==(p=u.metric)&&void 0!==p&&p.length?"danger":"secondary"}),isOpen:f,closePopover:()=>{b(!1)},anchorPosition:null!=E?E:"downRight",zIndex:8e3},l.a.createElement("div",{style:{width:620}},l.a.createElement(S,{onClose:()=>b(!1)},l.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.expression.metric.popoverTitle",defaultMessage:"Metric"})),l.a.createElement(i.EuiButtonGroup,{isFullWidth:!0,buttonSize:"compressed",legend:"Metric type",options:[{id:"metric-popover-default",label:"Default metric"},{id:"metric-popover-custom",label:"Custom metric"}],idSelected:h?"metric-popover-custom":"metric-popover-default",onChange:C}),l.a.createElement(i.EuiSpacer,{size:"m"}),h?l.a.createElement(l.a.Fragment,null,l.a.createElement(i.EuiFormRow,{fullWidth:!0},l.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},l.a.createElement(i.EuiFlexItem,{grow:!1},l.a.createElement(i.EuiSelect,{onChange:M,value:(null==a?void 0:a.aggregation)||"avg",options:v,fullWidth:!0})),l.a.createElement(i.EuiFlexItem,{grow:!1},l.a.createElement(i.EuiText,{color:"subdued"},l.a.createElement("span",null,s.i18n.translate("xpack.infra.waffle.customMetrics.of",{defaultMessage:"of"})))),l.a.createElement(i.EuiFlexItem,null,l.a.createElement(i.EuiComboBox,{fullWidth:!0,placeholder:s.i18n.translate("xpack.infra.waffle.customMetrics.fieldPlaceholder",{defaultMessage:"Select a field"}),singleSelection:{asPlainText:!0},selectedOptions:null!=a&&a.field?[{label:a.field}]:[],options:x,onChange:j,isClearable:!1,isInvalid:u.metric.length>0})))),l.a.createElement(i.EuiFormRow,{label:s.i18n.translate("xpack.infra.waffle.alerting.customMetrics.labelLabel",{defaultMessage:"Metric name (optional)"}),display:"rowCompressed",fullWidth:!0,helpText:s.i18n.translate("xpack.infra.waffle.alerting.customMetrics.helpText",{defaultMessage:'Choose a name to help identify your custom metric. Defaults to "<function> of <field name>".'})},l.a.createElement(i.EuiFieldText,{name:"label",placeholder:s.i18n.translate("xpack.infra.waffle.customMetrics.labelPlaceholder",{defaultMessage:'Choose a name to appear in the "Metric" dropdown'}),value:_,fullWidth:!0,onChange:I}))):l.a.createElement(i.EuiFormRow,{fullWidth:!0},l.a.createElement(i.EuiFlexGroup,null,l.a.createElement(i.EuiFlexItem,{className:"actOf__metricContainer"},l.a.createElement(i.EuiComboBox,{fullWidth:!0,singleSelection:{asPlainText:!0},"data-test-subj":"availablefieldsOptionsComboBox",isInvalid:u.metric.length>0,placeholder:y.text,options:w,noSuggestions:!w.length,selectedOptions:e?w.filter((t=>t.value===e.value)):[],renderOption:e=>e.label,onChange:e=>{e.length>0?(d(e[0].value),T(e[0].value)):d()}}))))))},S=({children:e,onClose:t})=>l.a.createElement(i.EuiPopoverTitle,null,l.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},l.a.createElement(i.EuiFlexItem,null,e),l.a.createElement(i.EuiFlexItem,{grow:!1},l.a.createElement(i.EuiButtonIcon,{iconType:"cross",color:"danger","aria-label":s.i18n.translate("xpack.infra.metrics.expressionItems.components.closablePopoverTitle.closeLabel",{defaultMessage:"Close"}),onClick:()=>t()})))),C=({value:e,options:t,onChange:a,popupPosition:r})=>{const[c,u]=Object(n.useState)(!1);return l.a.createElement(i.EuiPopover,{button:l.a.createElement(i.EuiExpression,{"data-test-subj":"nodeTypeExpression",description:s.i18n.translate("xpack.infra.metrics.alertFlyout.expression.for.descriptionLabel",{defaultMessage:"For"}),value:t[e].text,isActive:c,onClick:()=>{u(!0)}}),isOpen:c,closePopover:()=>{u(!1)},ownFocus:!0,anchorPosition:null!=r?r:"downLeft"},l.a.createElement("div",null,l.a.createElement(M,{onClose:()=>u(!1)},l.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.expression.for.popoverTitle",defaultMessage:"Node Type"})),l.a.createElement(i.EuiSelect,{"data-test-subj":"forExpressionSelect",value:e,fullWidth:!0,onChange:e=>{a(e.target.value),u(!1)},options:Object.values(t).map((e=>e))})))},M=({children:e,onClose:t})=>l.a.createElement(i.EuiPopoverTitle,null,l.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},l.a.createElement(i.EuiFlexItem,null,e),l.a.createElement(i.EuiFlexItem,{grow:!1},l.a.createElement(i.EuiButtonIcon,{iconType:"cross",color:"danger","aria-label":s.i18n.translate("xpack.infra.metrics.expressionItems.components.closablePopoverTitle.closeLabel",{defaultMessage:"Close"}),onClick:()=>t()}))));var j=a(99),U=a(22),I=a(50),w=a(48),F=a.n(w),N=a(79),D=a(111),P=a(84),W=a(112),z=a(134),V=a(135),B=a(136),G=a(123),Q=a(159),Y=a(78);const $=({expression:e,filterQuery:t,nodeType:a,sourceId:s})=>{var c,u,d,m,E;const p=Object(n.useMemo)((()=>({interval:`${e.timeSize||1}${e.timeUnit}`,from:F()().subtract(20*(e.timeSize||1),e.timeUnit).valueOf(),to:F()().valueOf(),forceInterval:!0,ignoreLookback:!0})),[e.timeSize,e.timeUnit]),f=e=>({...e,type:"custom"}),b=Object(Y.d)(),{loading:h,nodes:g}=Object(V.a)(t,"custom"===e.metric?[f(e.customMetric)]:[{type:e.metric}],[],a,s,0,b.accountId,b.region,!0,p),{uiSettings:R}=Object(U.b)().services,T={field:e.metric,aggregation:"avg",color:N.a.color0},_=(null==R?void 0:R.get("theme:darkMode"))||!1,A=Object(n.useMemo)((()=>{var e,t,a,n;const l=null===(e=g[0])||void 0===e||null===(t=e.metrics[0])||void 0===t?void 0:t.timeseries,i=null===(a=Object(r.first)(null==l?void 0:l.rows))||void 0===a?void 0:a.timestamp,o=null===(n=Object(r.last)(null==l?void 0:l.rows))||void 0===n?void 0:n.timestamp;return null==i||null==o?e=>`${e}`:Object(I.niceTimeFormatter)([i,o])}),[g]),y=Object(n.useCallback)(Object(B.a)("custom"===e.metric?f(e.customMetric):{type:e.metric}),[e.metric]);if(h||!g)return l.a.createElement(G.c,null);const L=t=>q(e.metric,t),O=e.threshold.map(L),x=null!==(c=null===(u=e.warningThreshold)||void 0===u?void 0:u.map(L))&&void 0!==c?c:[],v=O.slice().sort(),k=x.slice().sort(),S=[...v,...k].sort(),C=null===(d=g[0])||void 0===d||null===(m=d.metrics[0])||void 0===m?void 0:m.timeseries;if(!C||!C.rows||0===C.rows.length)return l.a.createElement(G.e,null);const M={...C,id:null===(E=g[0])||void 0===E?void 0:E.name,rows:C.rows.map((e=>{const t={...e};return S.forEach(((e,a)=>{t[Object(z.a)(T,`threshold_${a}`)]=e})),t}))},j=Object(r.first)(C.rows).timestamp,w=Object(r.last)(C.rows).timestamp,$=Object(W.a)(M,[T],!1),K={max:1.1*Math.max($.max,Object(r.last)(S)||$.max),min:.9*Math.min($.min,Object(r.first)(S)||$.min)};K.min===Object(r.first)(O)&&(K.min=.9*K.min);const{timeSize:H,timeUnit:X}=e,J=G.f[X];return l.a.createElement(l.a.Fragment,null,l.a.createElement(G.a,null,l.a.createElement(I.Chart,null,l.a.createElement(D.a,{type:P.b.bar,metric:T,id:"0",series:M,stack:!1}),l.a.createElement(Q.a,{comparator:e.comparator,threshold:O,sortedThresholds:v,color:N.a.color1,id:"critical",firstTimestamp:j,lastTimestamp:w,domain:K}),e.warningComparator&&e.warningThreshold&&l.a.createElement(Q.a,{comparator:e.warningComparator,threshold:x,sortedThresholds:k,color:N.a.color5,id:"warning",firstTimestamp:j,lastTimestamp:w,domain:K}),l.a.createElement(I.Axis,{id:"timestamp",position:I.Position.Bottom,showOverlappingTicks:!0,tickFormat:A}),l.a.createElement(I.Axis,{id:"values",position:I.Position.Left,tickFormat:y,domain:K}),l.a.createElement(I.Settings,{tooltip:G.i,theme:Object(G.g)(_)}))),l.a.createElement("div",{style:{textAlign:"center"}},"ALL"!==M.id?l.a.createElement(i.EuiText,{size:"xs",color:"subdued"},l.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alerts.dataTimeRangeLabelWithGrouping",defaultMessage:"Last {lookback} {timeLabel} of data for {id}",values:{id:M.id,timeLabel:J,lookback:20*H}})):l.a.createElement(i.EuiText,{size:"xs",color:"subdued"},l.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alerts.dataTimeRangeLabel",defaultMessage:"Last {lookback} {timeLabel}",values:{timeLabel:J,lookback:20*H}}))))},q=(e,t)=>K[e]?K[e](t):t,K={cpu:e=>Number(e)/100,memory:e=>Number(e)/100},H=Symbol("QUERY_INVALID"),X={metric:"cpu",comparator:u.a.GT,threshold:[],timeSize:1,timeUnit:"m",customMetric:{type:"custom",id:"alert-custom-metric",field:"",aggregation:"avg"}},J=e=>{const{http:t,notifications:a}=Object(U.b)().services,{setAlertParams:c,alertParams:u,errors:d,metadata:f}=e,{source:b,createDerivedIndexPattern:h}=Object(p.a)({sourceId:"default",fetch:t.fetch,toastWarning:a.toasts.addWarning}),[g,R]=Object(n.useState)(1),[T,_]=Object(n.useState)("m"),A=Object(n.useMemo)((()=>h()),[h]),y=Object(n.useCallback)(((e,t)=>{const a=u.criteria?u.criteria.slice():[];a[e]=t,c("criteria",a)}),[c,u.criteria]),L=Object(n.useCallback)((()=>{var e;const t=(null===(e=u.criteria)||void 0===e?void 0:e.slice())||[];t.push({...X,timeSize:null!=g?g:X.timeSize,timeUnit:null!=T?T:X.timeUnit}),c("criteria",t)}),[c,u.criteria,g,T]),x=Object(n.useCallback)((e=>{const t=u.criteria.slice();t.length>1&&(t.splice(e,1),c("criteria",t))}),[c,u.criteria]),v=Object(n.useCallback)((e=>{c("filterQueryText",e||"");try{c("filterQuery",Object(j.a)(e,A,!1)||"")}catch(e){c("filterQuery",H)}}),[A,c]),k=Object(n.useCallback)(Object(r.debounce)(v,500),[v]),S=Object(n.useMemo)((()=>({aggField:[],timeSizeUnit:[],timeWindowSize:[]})),[]),M=Object(n.useCallback)((e=>{const t=u.criteria.map((t=>({...t,timeSize:e})));R(e||void 0),c("criteria",t)}),[u.criteria,c]),I=Object(n.useCallback)((e=>{const t=u.criteria.map((t=>({...t,timeUnit:e})));_(e),c("criteria",t)}),[u.criteria,c]),w=Object(n.useCallback)((e=>{c("nodeType",e)}),[c]),F=Object(n.useCallback)((e=>v(e.target.value)),[v]),N=Object(n.useCallback)((()=>{const e=f;e&&e.options?c("criteria",[{...X,metric:e.options.metric.type,customMetric:O.d.is(e.options.metric)?e.options.metric:X.customMetric}]):c("criteria",[X])}),[f,c]),D=Object(n.useCallback)((()=>{const e=f;e&&e.filter&&(c("filterQueryText",e.filter),c("filterQuery",Object(j.a)(e.filter,A)||""))}),[f,A,c]);return Object(n.useEffect)((()=>{const e=f;u.nodeType||(e&&e.nodeType?c("nodeType",e.nodeType):c("nodeType","host")),u.criteria&&u.criteria.length?(R(u.criteria[0].timeSize),_(u.criteria[0].timeUnit)):N(),u.filterQuery||D(),u.sourceId||c("sourceId",(null==b?void 0:b.id)||"default")}),[f,A,X,b]),l.a.createElement(l.a.Fragment,null,l.a.createElement(i.EuiSpacer,{size:"m"}),l.a.createElement(i.EuiText,{size:"xs"},l.a.createElement("h4",null,l.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.conditions",defaultMessage:"Conditions"}))),l.a.createElement(te,null,l.a.createElement(ee,null,l.a.createElement(Z,null,l.a.createElement(C,{options:ie,value:u.nodeType||"host",onChange:w})))),l.a.createElement(i.EuiSpacer,{size:"xs"}),u.criteria&&u.criteria.map(((e,t)=>l.a.createElement(re,{nodeType:u.nodeType,canDelete:u.criteria.length>1,remove:x,addExpression:L,key:t,expressionId:t,setAlertParams:y,errors:d[t]||S,expression:e||{},fields:A.fields},l.a.createElement($,{expression:e,filterQuery:u.filterQuery,nodeType:u.nodeType,sourceId:u.sourceId,"data-test-subj":"preview-chart"})))),l.a.createElement(Z,null,l.a.createElement(m.ForLastExpression,{timeWindowSize:g,timeWindowUnit:T,errors:S,onChangeWindowSize:M,onChangeWindowUnit:I})),l.a.createElement("div",null,l.a.createElement(i.EuiButtonEmpty,{color:"primary",iconSide:"left",flush:"left",iconType:"plusInCircleFilled",onClick:L},l.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.addCondition",defaultMessage:"Add condition"}))),l.a.createElement(i.EuiSpacer,{size:"m"}),l.a.createElement(i.EuiCheckbox,{id:"metrics-alert-no-data-toggle",label:l.a.createElement(l.a.Fragment,null,s.i18n.translate("xpack.infra.metrics.alertFlyout.alertOnNoData",{defaultMessage:"Alert me if there's no data"})," ",l.a.createElement(i.EuiToolTip,{content:s.i18n.translate("xpack.infra.metrics.alertFlyout.noDataHelpText",{defaultMessage:"Enable this to trigger the action if the metric(s) do not report any data over the expected time period, or if the alert fails to query Elasticsearch"})},l.a.createElement(i.EuiIcon,{type:"questionInCircle",color:"subdued"}))),checked:u.alertOnNoData,onChange:e=>c("alertOnNoData",e.target.checked)}),l.a.createElement(i.EuiSpacer,{size:"m"}),l.a.createElement(i.EuiFormRow,{label:s.i18n.translate("xpack.infra.metrics.alertFlyout.filterLabel",{defaultMessage:"Filter (optional)"}),helpText:s.i18n.translate("xpack.infra.metrics.alertFlyout.filterHelpText",{defaultMessage:"Use a KQL expression to limit the scope of your alert trigger."}),fullWidth:!0,display:"rowCompressed"},f&&l.a.createElement(E.a,{derivedIndexPattern:A,onSubmit:v,onChange:k,value:u.filterQueryText})||l.a.createElement(i.EuiFieldSearch,{onChange:F,value:u.filterQueryText,fullWidth:!0})),l.a.createElement(i.EuiSpacer,{size:"m"}))};t.default=J;const Z=d.euiStyled.div`
  margin-left: 28px;
`,ee=Object(d.euiStyled)(i.EuiFlexGroup)`
  display: flex;
  flex-wrap: wrap;
  margin: 0 -4px;
`,te=d.euiStyled.div`
  padding: 0 4px;
`,ae=Object(d.euiStyled)(i.EuiHealth)`
  margin-left: 4px;
`,re=e=>{var t,a,d;const[m,E]=Object(n.useState)(!0),p=Object(n.useCallback)((()=>E(!m)),[m]),{children:A,setAlertParams:L,expression:x,errors:v,expressionId:S,remove:C,canDelete:M,fields:j}=e,{metric:U,comparator:I=u.a.GT,threshold:w=[],customMetric:F,warningThreshold:N=[],warningComparator:D}=x,[P,W]=Object(n.useState)(Boolean(null==N?void 0:N.length)),z=Object(n.useCallback)((e=>{const t=y.f.is(e)?e:Boolean(e)?"custom":void 0,a={...x,metric:t};L(S,a)}),[S,x,L]),V=Object(n.useCallback)((e=>{O.d.is(e)&&L(S,{...x,customMetric:e})}),[S,x,L]),B=Object(n.useCallback)((e=>{L(S,{...x,comparator:e})}),[S,x,L]),G=Object(n.useCallback)((e=>{L(S,{...x,warningComparator:e})}),[S,x,L]),Q=Object(n.useCallback)((e=>{e.join()!==x.threshold.join()&&L(S,{...x,threshold:e})}),[S,x,L]),Y=Object(n.useCallback)((e=>{var t;e.join()!==(null===(t=x.warningThreshold)||void 0===t?void 0:t.join())&&L(S,{...x,warningThreshold:e})}),[S,x,L]),$=Object(n.useCallback)((()=>{P?(W(!1),L(S,Object(r.omit)(x,"warningComparator","warningThreshold"))):(W(!0),L(S,{...x,warningComparator:I,warningThreshold:[]}))}),[P,W,L,I,x,S]),q=l.a.createElement(ne,{comparator:I,threshold:w,updateComparator:B,updateThreshold:Q,errors:null!==(t=v.critical)&&void 0!==t?t:{},metric:U}),K=P&&l.a.createElement(ne,{comparator:D||I,threshold:N,updateComparator:G,updateThreshold:Y,errors:null!==(a=v.warning)&&void 0!==a?a:{},metric:U}),H=Object(n.useMemo)((()=>{let t=R.b;switch(e.nodeType){case"awsEC2":t=b.b;break;case"awsRDS":t=g.b;break;case"awsS3":t=h.b;break;case"awsSQS":t=f.b;break;case"host":t=R.b;break;case"pod":t=_.b;break;case"container":t=T.b}return t.map(c.a)}),[e.nodeType]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(i.EuiFlexGroup,{gutterSize:"xs"},l.a.createElement(i.EuiFlexItem,{grow:!1},l.a.createElement(i.EuiButtonIcon,{iconType:m?"arrowDown":"arrowRight",onClick:p,"aria-label":s.i18n.translate("xpack.infra.metrics.alertFlyout.expandRowLabel",{defaultMessage:"Expand row."})})),l.a.createElement(i.EuiFlexItem,{grow:!0},l.a.createElement(ee,null,l.a.createElement(te,null,l.a.createElement(k,{metric:{value:U,text:(null===(d=H.find((e=>(null==e?void 0:e.value)===U)))||void 0===d?void 0:d.text)||""},metrics:H.filter((e=>void 0!==e&&void 0!==e.value)),onChange:z,onChangeCustom:V,errors:v,customMetric:F,fields:j})),!P&&q),P&&l.a.createElement(l.a.Fragment,null,l.a.createElement(ee,null,q,l.a.createElement(ae,{color:"danger"},l.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.criticalThreshold",defaultMessage:"Alert"}))),l.a.createElement(ee,null,K,l.a.createElement(ae,{color:"warning"},l.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.warningThreshold",defaultMessage:"Warning"})),l.a.createElement(i.EuiButtonIcon,{"aria-label":s.i18n.translate("xpack.infra.metrics.alertFlyout.removeWarningThreshold",{defaultMessage:"Remove warningThreshold"}),iconSize:"s",color:"subdued",iconType:"crossInACircleFilled",onClick:$}))),!P&&l.a.createElement(l.a.Fragment,null," ",l.a.createElement(i.EuiSpacer,{size:"xs"}),l.a.createElement(ee,null,l.a.createElement(i.EuiButtonEmpty,{color:"primary",flush:"left",size:"xs",iconType:"plusInCircleFilled",onClick:$},l.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.addWarningThreshold",defaultMessage:"Add warning threshold"}))))),M&&l.a.createElement(i.EuiFlexItem,{grow:!1},l.a.createElement(i.EuiButtonIcon,{"aria-label":s.i18n.translate("xpack.infra.metrics.alertFlyout.removeCondition",{defaultMessage:"Remove condition"}),color:"danger",iconType:"trash",onClick:()=>C(S)}))),m?l.a.createElement("div",{style:{padding:"0 0 0 28px"}},A):null,l.a.createElement(i.EuiSpacer,{size:"s"}))},ne=({updateComparator:e,updateThreshold:t,threshold:a,metric:r,comparator:n,errors:o})=>{var s;return l.a.createElement(l.a.Fragment,null,l.a.createElement(te,null,l.a.createElement(m.ThresholdExpression,{thresholdComparator:n||u.a.GT,threshold:a,onChangeSelectedThresholdComparator:e,onChangeSelectedThreshold:t,errors:o})),r&&l.a.createElement("div",{style:{alignSelf:"center"}},l.a.createElement(i.EuiText,{size:"s"},(null===(s=oe[r])||void 0===s?void 0:s.label)||"")))},le=e=>Object(A.b)(e).displayName,ie={host:{text:le("host"),value:"host"},pod:{text:le("pod"),value:"pod"},container:{text:le("container"),value:"container"},awsEC2:{text:le("awsEC2"),value:"awsEC2"},awsS3:{text:le("awsS3"),value:"awsS3"},awsRDS:{text:le("awsRDS"),value:"awsRDS"},awsSQS:{text:le("awsSQS"),value:"awsSQS"}},oe={count:{label:""},cpu:{label:"%"},memory:{label:"%"},rx:{label:"bits/s"},tx:{label:"bits/s"},logRate:{label:"/s"},diskIOReadBytes:{label:"bytes/s"},diskIOWriteBytes:{label:"bytes/s"},s3BucketSize:{label:"bytes"},s3TotalRequests:{label:""},s3NumberOfObjects:{label:""},s3UploadBytes:{label:"bytes"},s3DownloadBytes:{label:"bytes"},sqsOldestMessage:{label:"seconds"},rdsLatency:{label:"ms"},custom:{label:""}}},297:function(e,t,a){"use strict";a.r(t),a.d(t,"createInventoryMetricAlertType",(function(){return p}));var r=a(2),n=a(1),l=a.n(n),i=a(85);var o=a(292);function s({criteria:e,filterQuery:t}){const a={errors:{}},n={};return a.errors=n,t===o.QUERY_INVALID&&(n.filterQuery=[r.i18n.translate("xpack.infra.metrics.alertFlyout.error.invalidFilterQuery",{defaultMessage:"Filter query is invalid."})]),e&&e.length?(e.forEach(((e,t)=>{var a;const l=t.toString();n[l]=n[l]||{timeSizeUnit:[],timeWindowSize:[],critical:{threshold0:[],threshold1:[]},warning:{threshold0:[],threshold1:[]},metric:[]},e.threshold&&e.threshold.length||n[l].critical.threshold0.push(r.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdRequired",{defaultMessage:"Threshold is required."})),e.warningThreshold&&!e.warningThreshold.length&&n[l].warning.threshold0.push(r.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdRequired",{defaultMessage:"Threshold is required."}));for(const t of[{comparator:e.comparator,threshold:e.threshold,type:"critical"},{comparator:e.warningComparator,threshold:e.warningThreshold,type:"warning"}]){const{comparator:e,threshold:a,type:o}=t;a&&a.length&&![...a].every(c)&&[...a].forEach(((e,t)=>{if(!c(e)){const e=0===t?"threshold0":"threshold1";n[l][o][e].push(r.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdTypeRequired",{defaultMessage:"Thresholds must contain a valid number."}))}})),e===i.a.BETWEEN&&(!a||a.length<2)&&n[l][o].threshold1.push(r.i18n.translate("xpack.infra.metrics.alertFlyout.error.thresholdRequired",{defaultMessage:"Threshold is required."}))}e.timeSize||n[l].timeWindowSize.push(r.i18n.translate("xpack.infra.metrics.alertFlyout.error.timeRequred",{defaultMessage:"Time size is Required."})),e.metric||n[l].metric.push(r.i18n.translate("xpack.infra.metrics.alertFlyout.error.metricRequired",{defaultMessage:"Metric is required."})),"custom"!==e.metric||null!==(a=e.customMetric)&&void 0!==a&&a.field||n[l].metric.push(r.i18n.translate("xpack.infra.metrics.alertFlyout.error.customMetricFieldRequired",{defaultMessage:"Field is required."}))})),a):a}const c=e=>"number"==typeof e;var u=a(100),d=a(17),m=a(90);const E=({fields:e})=>{var t;const a=null!==(t=e[u.ALERT_REASON])&&void 0!==t?t:"-",r=function(e){try{return"string"==typeof e?JSON.parse(e):void 0}catch(e){return}}(e[u.ALERT_RULE_PARAMS]);let n="/app/metrics/link-to/inventory?";if(r){const t={nodeType:r.nodeType,timestamp:Date.parse(e[u.TIMESTAMP]),customMetric:""},a=r.criteria[0];if(a.customMetric&&"alert-custom-metric"!==a.customMetric.id){const e=Object(d.encode)(a.customMetric);t.customMetric=e,t.metric=e}else t.metric=Object(d.encode)({type:a.metric});n+=Object(m.stringify)(t)}return{reason:a,link:n}};function p(){return{id:"metrics.alert.inventory.threshold",description:r.i18n.translate("xpack.infra.metrics.inventory.alertFlyout.alertDescription",{defaultMessage:"Alert when the inventory exceeds a defined threshold."}),iconClass:"bell",documentationUrl:e=>`${e.links.observability.infrastructureThreshold}`,alertParamsExpression:l.a.lazy((()=>Promise.resolve().then(a.bind(null,292)))),validate:s,defaultActionMessage:r.i18n.translate("xpack.infra.metrics.alerting.inventory.threshold.defaultActionMessage",{defaultMessage:"\\{\\{alertName\\}\\} - \\{\\{context.group\\}\\} is in a state of \\{\\{context.alertState\\}\\}\n\nReason:\n\\{\\{context.reason\\}\\}\n"}),requiresAppContext:!1,format:E}}},85:function(e,t,a){"use strict";let r,n,l;a.d(t,"a",(function(){return r})),function(e){e.GT=">",e.LT="<",e.GT_OR_EQ=">=",e.LT_OR_EQ="<=",e.BETWEEN="between",e.OUTSIDE_RANGE="outside"}(r||(r={})),function(e){e.COUNT="count",e.AVERAGE="avg",e.SUM="sum",e.MIN="min",e.MAX="max",e.RATE="rate",e.CARDINALITY="cardinality",e.P95="p95",e.P99="p99"}(n||(n={})),function(e){e[e.OK=0]="OK",e[e.ALERT=1]="ALERT",e[e.WARNING=2]="WARNING",e[e.NO_DATA=3]="NO_DATA",e[e.ERROR=4]="ERROR"}(l||(l={}))},90:function(e,t,a){"use strict";const r=a(118),n=a(119),l=a(120);function i(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function o(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function s(e,t){return t.decode?n(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function u(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=u(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function m(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function E(e,t){i((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const a=function(e){let t;switch(e.arrayFormat){case"index":return(e,a,r)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=a):r[e]=a};case"bracket":return(e,a,r)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],a):r[e]=[a]:r[e]=a};case"comma":case"separator":return(t,a,r)=>{const n="string"==typeof a&&a.split("").indexOf(e.arrayFormatSeparator)>-1?a.split(e.arrayFormatSeparator).map((t=>s(t,e))):null===a?a:s(a,e);r[t]=n};default:return(e,t,a)=>{void 0!==a[e]?a[e]=[].concat(a[e],t):a[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const n of e.split("&")){let[e,i]=l(t.decode?n.replace(/\+/g," "):n,"=");i=void 0===i?null:["comma","separator"].includes(t.arrayFormat)?i:s(i,t),a(s(e,t),i,r)}for(const e of Object.keys(r)){const a=r[e];if("object"==typeof a&&null!==a)for(const e of Object.keys(a))a[e]=m(a[e],t);else r[e]=m(a,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const a=r[t];return Boolean(a)&&"object"==typeof a&&!Array.isArray(a)?e[t]=c(a):e[t]=a,e}),Object.create(null))}t.extract=d,t.parse=E,t.stringify=(e,t)=>{if(!e)return"";i((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const a=a=>t.skipNull&&null==e[a]||t.skipEmptyString&&""===e[a],r=function(e){switch(e.arrayFormat){case"index":return t=>(a,r)=>{const n=a.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?a:null===r?[...a,[o(t,e),"[",n,"]"].join("")]:[...a,[o(t,e),"[",o(n,e),"]=",o(r,e)].join("")]};case"bracket":return t=>(a,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?a:null===r?[...a,[o(t,e),"[]"].join("")]:[...a,[o(t,e),"[]=",o(r,e)].join("")];case"comma":case"separator":return t=>(a,r)=>null==r||0===r.length?a:0===a.length?[[o(t,e),"=",o(r,e)].join("")]:[[a,o(r,e)].join(e.arrayFormatSeparator)];default:return t=>(a,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?a:null===r?[...a,o(t,e)]:[...a,[o(t,e),"=",o(r,e)].join("")]}}(t),n={};for(const t of Object.keys(e))a(t)||(n[t]=e[t]);const l=Object.keys(n);return!1!==t.sort&&l.sort(t.sort),l.map((a=>{const n=e[a];return void 0===n?"":null===n?o(a,t):Array.isArray(n)?n.reduce(r(a),[]).join("&"):o(a,t)+"="+o(n,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[a,r]=l(e,"#");return Object.assign({url:a.split("?")[0]||"",query:E(d(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:s(r,t)}:{})},t.stringifyUrl=(e,a)=>{a=Object.assign({encode:!0,strict:!0},a);const r=u(e.url).split("?")[0]||"",n=t.extract(e.url),l=t.parse(n,{sort:!1}),i=Object.assign(l,e.query);let s=t.stringify(i,a);s&&(s=`?${s}`);let c=function(e){let t="";const a=e.indexOf("#");return-1!==a&&(t=e.slice(a)),t}(e.url);return e.fragmentIdentifier&&(c=`#${o(e.fragmentIdentifier,a)}`),`${r}${s}${c}`}},97:function(e,t,a){"use strict";a.d(t,"b",(function(){return n}));var r=a(85);a.d(t,"a",(function(){return r.a}));const n="metrics.alert.threshold";let l;!function(e){e.COUNT="count",e.AVERAGE="avg",e.SUM="sum",e.MIN="min",e.MAX="max",e.RATE="rate",e.CARDINALITY="cardinality",e.P95="p95",e.P99="p99"}(l||(l={}))}}]);