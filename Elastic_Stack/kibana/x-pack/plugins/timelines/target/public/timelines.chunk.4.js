/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.timelines_bundle_jsonpfunction=window.timelines_bundle_jsonpfunction||[]).push([[4],{104:function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"a",(function(){return i})),s.d(t,"c",(function(){return l})),s.d(t,"d",(function(){return c})),s.d(t,"e",(function(){return o})),s.d(t,"f",(function(){return d})),s.d(t,"j",(function(){return u})),s.d(t,"h",(function(){return r})),s.d(t,"i",(function(){return m})),s.d(t,"g",(function(){return p}));var a=s(4);a.i18n.translate("xpack.timelines.cases.timeline.actions.addCase",{defaultMessage:"Add to case"});const n=a.i18n.translate("xpack.timelines.cases.timeline.actions.addNewCase",{defaultMessage:"Add to new case"}),i=a.i18n.translate("xpack.timelines.cases.timeline.actions.addExistingCase",{defaultMessage:"Add to existing case"}),l=a.i18n.translate("xpack.timelines.cases.timeline.actions.addToCaseAriaLabel",{defaultMessage:"Attach alert to case"}),c=a.i18n.translate("xpack.timelines.cases.timeline.actions.addToCaseTooltip",{defaultMessage:"Add to case"}),o=e=>a.i18n.translate("xpack.timelines.cases.timeline.actions.caseCreatedSuccessToast",{values:{title:e},defaultMessage:'An alert has been added to "{title}"'}),d=a.i18n.translate("xpack.timelines.cases.timeline.actions.caseCreatedSuccessToastText",{defaultMessage:"Alerts in this case have their status synched with the case status"}),u=a.i18n.translate("xpack.timelines.cases.timeline.actions.caseCreatedSuccessToastViewCaseLink",{defaultMessage:"View Case"}),r=a.i18n.translate("xpack.timelines.cases.timeline.actions.permissionsMessage",{defaultMessage:"You are currently missing the required permissions to attach alerts to cases. Please contact your administrator for further assistance."}),m=a.i18n.translate("xpack.timelines.cases.timeline.actions.unsupportedEventsMessage",{defaultMessage:"This event cannot be attached to a case"}),p=a.i18n.translate("xpack.timelines.cases.caseView.create",{defaultMessage:"Create new case"})},107:function(e,t,s){"use strict";s.d(t,"b",(function(){return h})),s.d(t,"a",(function(){return w}));var a=s(3),n=s(0),i=s.n(n),l=s(96),c=s(12),o=s(39),d=s(26),u=s(13),r=s(34),m=s(6),p=s.n(m),C=s(2),b=s(104);const v=p()(C.EuiText).withConfig({displayName:"EuiTextStyled",componentId:"sc-hx7f16-0"})(["",""],(({theme:e})=>{var t,s,a;return`\n    margin-bottom: ${null!==(t=null===(s=e.eui)||void 0===s||null===(a=s.paddingSizes)||void 0===a?void 0:a.s)&&void 0!==t?t:8}px;\n  `})),O=({caseId:e,syncAlerts:t,onViewCaseClick:s})=>{const a=Object(n.useCallback)((()=>s(e)),[e,s]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(v,{size:"s","data-test-subj":"toaster-content-sync-text"},b.f),i.a.createElement(C.EuiButtonEmpty,{size:"xs",flush:"left",onClick:a,"data-test-subj":"toaster-content-case-view-link"},b.j))},f=Object(n.memo)(O),g=p.a.span.withConfig({displayName:"Title",componentId:"sc-1y12jr1-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;"],3),y=e=>Object(a.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`,j=e=>`/create${y(null!=e?e:void 0)}`,h=({event:e,useInsertTimeline:t,casePermissions:s,appId:o,onClose:m})=>{var p,C,v;const O=null!==(p=null==e?void 0:e.ecs._id)&&void 0!==p?p:"",h=null!==(C=null==e?void 0:e.ecs._index)&&void 0!==C?C:"",E=Object(c.useDispatch)(),k=Object(r.a)((e=>e.timeline?e.timeline.timelineById[O]:e.timelineById[O])),A=Object(n.useMemo)((()=>!!k&&k.isAddToExistingCaseOpen),[k]),x=Object(n.useMemo)((()=>!!k&&k.isCreateNewCaseOpen),[k]),{application:{navigateToApp:T,getUrlForApp:I,navigateToUrl:M},notifications:{toasts:S}}=Object(d.useKibana)().services,[N,_]=Object(n.useState)(!1),F=Object(n.useCallback)((()=>_(!0)),[]),$=Object(n.useCallback)((()=>_(!1)),[]),L=Object(n.useMemo)((()=>{if(void 0!==e){return[...e.data].some((({field:e})=>"kibana.alert.uuid"===e))}return!1}),[e]),U=Object(n.useMemo)((()=>{var t,s;return!Object(a.isEmpty)(null==e||null===(t=e.ecs.signal)||void 0===t||null===(s=t.rule)||void 0===s?void 0:s.id)}),[e])||L,z=null!==(v=null==s?void 0:s.crud)&&void 0!==v&&v,R=!z||!U,P=Object(n.useCallback)((e=>{const t=(({id:e,search:t,subCaseId:s})=>s?`/${encodeURIComponent(e)}/sub-cases/${encodeURIComponent(s)}${y(null!=t?t:void 0)}`:`/${encodeURIComponent(e)}${y(null!=t?t:void 0)}`)({id:e}),s=I(o);M(`${s}/cases/${t}`)}),[M,o,I]),B=Object(l.useLocation)().search,D=Object(n.useMemo)((()=>B),[B]),V=Object(n.useMemo)((()=>I("cases")+j(D)),[I,D]),G=Object(n.useCallback)((async(t,s,a)=>{E(u.c.setOpenAddToNewCase({id:O,isOpen:!1}));const{ruleId:n,ruleName:i}=w(e);s&&await s({caseId:t.id,data:{type:"alert",alertId:O,index:null!=h?h:"",rule:{id:n,name:i},owner:o},updateCase:a})}),[O,h,o,E,e]),K=Object(n.useCallback)((async e=>{E(u.c.setOpenAddToExistingCase({id:O,isOpen:!1})),((e,t,s)=>{e.addSuccess({color:"success",iconType:"check",title:Object(d.toMountPoint)(i.a.createElement(g,null,b.e(t.title))),text:Object(d.toMountPoint)(i.a.createElement(f,{caseId:t.id,syncAlerts:t.settings.syncAlerts,onViewCaseClick:s}))})})(S,e,P)}),[P,S,E,O]),W=Object(n.useCallback)((async e=>(e.preventDefault(),T(o,{deepLinkId:"securitySolution"===o?"case":"cases",path:j(D)}))),[T,D,o]),Z=Object(n.useCallback)((e=>{null==e&&E(u.c.setOpenAddToNewCase({id:O,isOpen:!0})),E(u.c.setOpenAddToExistingCase({id:O,isOpen:!1}))}),[E,O]);return{addNewCaseClick:Object(n.useCallback)((()=>{$(),E(u.c.setOpenAddToNewCase({id:O,isOpen:!0})),m&&m()}),[m,$,E,O]),addExistingCaseClick:Object(n.useCallback)((()=>{$(),E(u.c.setOpenAddToExistingCase({id:O,isOpen:!0})),m&&m()}),[m,$,E,O]),onCaseClicked:Z,goToCreateCase:W,onCaseSuccess:K,attachAlertToCase:G,createCaseUrl:V,isAllCaseModalOpen:A,isDisabled:R,userCanCrud:z,isEventSupported:U,openPopover:F,closePopover:$,isPopoverOpen:N,isCreateCaseFlyoutOpen:x}};function w(e){var t,s,n,i;const l=e&&e.data.find((({field:e})=>e===o.ALERT_RULE_UUID)),c=e&&e.data.find((({field:e})=>e===o.ALERT_RULE_NAME)),d=l&&l.value&&l.value[0],u=c&&c.value&&c.value[0];return{ruleId:null!==(t=null!==(s=null!=d?d:Object(a.get)(`ecs.${o.ALERT_RULE_UUID}[0]`,e))&&void 0!==s?s:Object(a.get)("ecs.signal.rule.id[0]",e))&&void 0!==t?t:null,ruleName:null!==(n=null!==(i=null!=u?u:Object(a.get)(`ecs.${o.ALERT_RULE_NAME}[0]`,e))&&void 0!==i?i:Object(a.get)("ecs.signal.rule.name[0]",e))&&void 0!==n?n:null}}},124:function(e,t,s){"use strict";s.r(t),s.d(t,"AddToCaseAction",(function(){return h}));var a=s(0),n=s.n(a),i=s(12),l=s(98),c=s(107),o=s(26),d=s(6),u=s.n(d),r=s(2),m=s(104);const p=u()(r.EuiFlyout).withConfig({displayName:"StyledFlyout",componentId:"sc-1d4zw6z-0"})(["",""],(({theme:e})=>`\n    z-index: ${e.eui.euiZLevel5};\n  `)),C="create-case-flyout-mask-overlay",b=Object(d.createGlobalStyle)([".","{","}"],C,(({theme:e})=>`\n    z-index: ${e.eui.euiZLevel5};\n  `)),v=u()(r.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1d4zw6z-1"})(["",""],(({theme:e})=>`\n    && .euiFlyoutBody__overflow {\n      overflow-y: auto;\n      overflow-x: hidden;\n    }\n\n    && .euiFlyoutBody__overflowContent {\n      display: block;\n      padding: ${e.eui.paddingSizes.l} ${e.eui.paddingSizes.l} 70px;\n      height: auto;\n    }\n  `)),O=u.a.div.withConfig({displayName:"FormWrapper",componentId:"sc-1d4zw6z-2"})(["width:100%;"]),f=({afterCaseCreated:e,onCloseFlyout:t,onSuccess:s,appId:i,disableAlerts:l})=>{const{cases:c}=Object(o.useKibana)().services,d=Object(a.useMemo)((()=>({afterCaseCreated:e,onCancel:t,onSuccess:s,withSteps:!1,owner:[i],disableAlerts:l})),[e,t,s,i,l]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(b,null),n.a.createElement(p,{onClose:t,"data-test-subj":"create-case-flyout",maskProps:{className:C}},n.a.createElement(r.EuiFlyoutHeader,{hasBorder:!0},n.a.createElement(r.EuiTitle,{size:"m"},n.a.createElement("h2",null,m.g))),n.a.createElement(v,null,n.a.createElement(O,null,c.getCreateCase(d)))))},g=Object(a.memo)(f);g.displayName="CreateCaseFlyout";var y=s(10);const j=({ariaLabel:e=m.c,event:t,useInsertTimeline:s,casePermissions:d,appId:u,onClose:r,disableAlerts:p})=>{var C,b;const v=null!==(C=null==t?void 0:t.ecs._id)&&void 0!==C?C:"",O=null!==(b=null==t?void 0:t.ecs._index)&&void 0!==b?b:"",f=Object(i.useDispatch)(),{cases:j}=Object(o.useKibana)().services,{onCaseClicked:h,goToCreateCase:w,onCaseSuccess:E,attachAlertToCase:k,createCaseUrl:A,isAllCaseModalOpen:x,isCreateCaseFlyoutOpen:T}=Object(c.b)({event:t,useInsertTimeline:s,casePermissions:d,appId:u,onClose:r}),I=Object(a.useMemo)((()=>{var e;const{ruleId:a,ruleName:n}=Object(c.a)(t);return{alertData:{alertId:v,index:null!=O?O:"",rule:{id:a,name:n},owner:u},createCaseNavigation:{href:A,onClick:w},hooks:{useInsertTimeline:s},hiddenStatuses:[l.CaseStatuses.closed,l.StatusAll],onRowClick:h,updateCase:E,userCanCrud:null!==(e=null==d?void 0:d.crud)&&void 0!==e&&e,owner:[u],onClose:()=>f(y.tGridActions.setOpenAddToExistingCase({id:v,isOpen:!1}))}}),[null==d?void 0:d.crud,E,h,A,w,v,O,u,f,s,t]),M=Object(a.useCallback)((()=>{f(y.tGridActions.setOpenAddToNewCase({id:v,isOpen:!1}))}),[f,v]);return n.a.createElement(n.a.Fragment,null,T&&n.a.createElement(g,{afterCaseCreated:k,onCloseFlyout:M,onSuccess:E,useInsertTimeline:s,appId:u,disableAlerts:p}),x&&j.getAllCasesSelectorModal(I))},h=Object(a.memo)(j);t.default=h}}]);