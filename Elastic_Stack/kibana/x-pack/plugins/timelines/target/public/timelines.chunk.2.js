/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.timelines_bundle_jsonpfunction=window.timelines_bundle_jsonpfunction||[]).push([[2,13,14,15],{114:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return s}));var a=n(4);a.i18n.translate("xpack.timelines.timeline.body.notes.addOrViewNotesForThisEventTooltip",{defaultMessage:"Add notes for this event"});const i=a.i18n.translate("xpack.timelines.tgrid.body.ariaLabel",{defaultMessage:"Alerts"}),l=(a.i18n.translate("xpack.timelines.timeline.body.notes.disableEventTooltip",{defaultMessage:"Notes may not be added here while editing a template timeline"}),a.i18n.translate("xpack.timelines.timeline.body.copyToClipboardButtonLabel",{defaultMessage:"Copy to Clipboard"})),s=(a.i18n.translate("xpack.timelines.timeline.body.actions.investigateLabel",{defaultMessage:"Investigate"}),a.i18n.translate("xpack.timelines.timeline.body.pinning.unpinnedTooltip",{defaultMessage:"Unpinned event"}),a.i18n.translate("xpack.timelines.timeline.body.pinning.pinnedTooltip",{defaultMessage:"Pinned event"}),a.i18n.translate("xpack.timelines.timeline.body.pinning.pinnnedWithNotesTooltip",{defaultMessage:"This event cannot be unpinned because it has notes"}),a.i18n.translate("xpack.timelines.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),a.i18n.translate("xpack.timelines.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),a.i18n.translate("xpack.timelines.timeline.body.pinning.disablePinnnedTooltip",{defaultMessage:"This event may not be pinned while editing a template timeline"}),a.i18n.translate("xpack.timelines.timeline.body.actions.viewDetailsAriaLabel",{defaultMessage:"View details"}),a.i18n.translate("xpack.timelines.timeline.body.actions.viewSummaryLabel",{defaultMessage:"View summary"}),a.i18n.translate("xpack.timelines.timeline.body.actions.expandEventTooltip",{defaultMessage:"View details"}),a.i18n.translate("xpack.timelines.timeline.body.actions.collapseAriaLabel",{defaultMessage:"Collapse"}),a.i18n.translate("xpack.timelines.timeline.body.actions.investigateInResolverTooltip",{defaultMessage:"Analyze event"}),a.i18n.translate("xpack.timelines.timeline.body.actions.investigateInResolverDisabledTooltip",{defaultMessage:"This event cannot be analyzed since it has incompatible field mappings"}),e=>a.i18n.translate("xpack.timelines.timeline.alertsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {alert} other {alerts}}"}))},115:function(e,t,n){"use strict";n.r(t),n.d(t,"LoadingPanel",(function(){return d})),n.d(t,"LoadingStaticPanel",(function(){return c})),n.d(t,"LoadingStaticContentPanel",(function(){return u})),n.d(t,"default",(function(){return d}));var a=n(2),i=n(0),l=n.n(i),s=n(6),r=n.n(s);const o=r()(a.EuiFlexItem).withConfig({displayName:"SpinnerFlexItem",componentId:"sc-zdczxa-0"})(["margin-right:5px;"]);o.displayName="SpinnerFlexItem";const d=l.a.memo((({dataTestSubj:e="",height:t="auto",showBorder:n=!0,text:i,width:s,position:r="relative",zIndex:d="inherit"})=>l.a.createElement(c,{className:"app-loading",height:t,width:s,position:r,zIndex:d},l.a.createElement(u,null,l.a.createElement(a.EuiPanel,{"data-test-subj":e,className:n?"":"euiPanel-loading-hide-border"},l.a.createElement(a.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},l.a.createElement(o,{grow:!1},l.a.createElement(a.EuiLoadingSpinner,{size:"m"})),l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(a.EuiText,null,i))))))));d.displayName="LoadingPanel";const c=r.a.div.withConfig({displayName:"LoadingStaticPanel",componentId:"sc-zdczxa-1"})(["height:",";position:",";width:",";overflow:hidden;display:flex;flex-direction:column;justify-content:center;z-index:",";"],(({height:e})=>e),(({position:e})=>e),(({width:e})=>e),(({zIndex:e})=>e));c.displayName="LoadingStaticPanel";const u=r.a.div.withConfig({displayName:"LoadingStaticContentPanel",componentId:"sc-zdczxa-2"})(["flex:0 0 auto;align-self:center;text-align:center;height:fit-content;.euiPanel.euiPanel--paddingMedium{padding:10px;}"]);u.displayName="LoadingStaticContentPanel"},116:function(e,t,n){"use strict";n.r(t),n.d(t,"FieldBrowserWrappedComponent",(function(){return d})),n.d(t,"default",(function(){return d}));var a=n(0),i=n.n(a),l=n(12),s=n(17),r=n(45);const o={},d=e=>{var t;const{store:n,...a}=e,d={...a,browserFields:null!==(t=a.browserFields)&&void 0!==t?t:o};return i.a.createElement(l.Provider,{store:n},i.a.createElement(s.I18nProvider,null,i.a.createElement(r.a,d)))};d.displayName="FieldBrowserWrappedComponent"},117:function(e,t,n){"use strict";n.r(t),n.d(t,"Updated",(function(){return c})),n.d(t,"LastUpdatedAt",(function(){return m})),n.d(t,"default",(function(){return m}));var a=n(2),i=n(17),l=n(0),s=n.n(l),r=n(4);const o=r.i18n.translate("xpack.timelines.lastUpdated.updating",{defaultMessage:"Updating..."}),d=r.i18n.translate("xpack.timelines.lastUpdated.updated",{defaultMessage:"Updated"}),c=s.a.memo((({date:e,prefix:t,updatedAt:n})=>s.a.createElement(s.a.Fragment,null,t,s.a.createElement(i.FormattedRelative,{"data-test-subj":"last-updated-at-date",key:`formatedRelative-${e}`,value:new Date(n)}))));c.displayName="Updated";const u=` ${d} `,m=s.a.memo((({compact:e=!1,updatedAt:t,showUpdating:n=!1})=>{const[i,r]=Object(l.useState)(Date.now());Object(l.useEffect)((()=>{const e=setInterval((()=>{r(Date.now())}),1e4);return()=>{clearInterval(e)}}),[]);const d=Object(l.useMemo)((()=>n?s.a.createElement("span",null," ",o):e?null:s.a.createElement(c,{date:i,prefix:u,updatedAt:t})),[e,i,n,t]);return s.a.createElement(a.EuiToolTip,{"data-test-subj":"timeline-stream-tool-tip",content:s.a.createElement(c,{date:i,prefix:u,updatedAt:t})},s.a.createElement(a.EuiText,{color:"subdued",size:"xs"},d))}));m.displayName="LastUpdatedAt"},124:function(e,t,n){"use strict";n.r(t),n.d(t,"AddToCaseAction",(function(){return C}));var a=n(0),i=n.n(a),l=n(12),s=n(98),r=n(107),o=n(26),d=n(6),c=n.n(d),u=n(2),m=n(104);const p=c()(u.EuiFlyout).withConfig({displayName:"StyledFlyout",componentId:"sc-1d4zw6z-0"})(["",""],(({theme:e})=>`\n    z-index: ${e.eui.euiZLevel5};\n  `)),b="create-case-flyout-mask-overlay",g=Object(d.createGlobalStyle)([".","{","}"],b,(({theme:e})=>`\n    z-index: ${e.eui.euiZLevel5};\n  `)),h=c()(u.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1d4zw6z-1"})(["",""],(({theme:e})=>`\n    && .euiFlyoutBody__overflow {\n      overflow-y: auto;\n      overflow-x: hidden;\n    }\n\n    && .euiFlyoutBody__overflowContent {\n      display: block;\n      padding: ${e.eui.paddingSizes.l} ${e.eui.paddingSizes.l} 70px;\n      height: auto;\n    }\n  `)),f=c.a.div.withConfig({displayName:"FormWrapper",componentId:"sc-1d4zw6z-2"})(["width:100%;"]),E=({afterCaseCreated:e,onCloseFlyout:t,onSuccess:n,appId:l,disableAlerts:s})=>{const{cases:r}=Object(o.useKibana)().services,d=Object(a.useMemo)((()=>({afterCaseCreated:e,onCancel:t,onSuccess:n,withSteps:!1,owner:[l],disableAlerts:s})),[e,t,n,l,s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(g,null),i.a.createElement(p,{onClose:t,"data-test-subj":"create-case-flyout",maskProps:{className:b}},i.a.createElement(u.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(u.EuiTitle,{size:"m"},i.a.createElement("h2",null,m.g))),i.a.createElement(h,null,i.a.createElement(f,null,r.getCreateCase(d)))))},v=Object(a.memo)(E);v.displayName="CreateCaseFlyout";var w=n(10);const y=({ariaLabel:e=m.c,event:t,useInsertTimeline:n,casePermissions:d,appId:c,onClose:u,disableAlerts:p})=>{var b,g;const h=null!==(b=null==t?void 0:t.ecs._id)&&void 0!==b?b:"",f=null!==(g=null==t?void 0:t.ecs._index)&&void 0!==g?g:"",E=Object(l.useDispatch)(),{cases:y}=Object(o.useKibana)().services,{onCaseClicked:C,goToCreateCase:x,onCaseSuccess:j,attachAlertToCase:O,createCaseUrl:S,isAllCaseModalOpen:I,isCreateCaseFlyoutOpen:k}=Object(r.b)({event:t,useInsertTimeline:n,casePermissions:d,appId:c,onClose:u}),F=Object(a.useMemo)((()=>{var e;const{ruleId:a,ruleName:i}=Object(r.a)(t);return{alertData:{alertId:h,index:null!=f?f:"",rule:{id:a,name:i},owner:c},createCaseNavigation:{href:S,onClick:x},hooks:{useInsertTimeline:n},hiddenStatuses:[s.CaseStatuses.closed,s.StatusAll],onRowClick:C,updateCase:j,userCanCrud:null!==(e=null==d?void 0:d.crud)&&void 0!==e&&e,owner:[c],onClose:()=>E(w.tGridActions.setOpenAddToExistingCase({id:h,isOpen:!1}))}}),[null==d?void 0:d.crud,j,C,S,x,h,f,c,E,n,t]),P=Object(a.useCallback)((()=>{E(w.tGridActions.setOpenAddToNewCase({id:h,isOpen:!1}))}),[E,h]);return i.a.createElement(i.a.Fragment,null,k&&i.a.createElement(v,{afterCaseCreated:O,onCloseFlyout:P,onSuccess:j,useInsertTimeline:n,appId:c,disableAlerts:p}),I&&y.getAllCasesSelectorModal(F))},C=Object(a.memo)(y);t.default=C},125:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validFeatureIds=t.isValidFeatureId=t.getSafeSortIds=t.getEsQueryConfig=t.AlertConsumers=void 0;const a={APM:"apm",LOGS:"logs",INFRASTRUCTURE:"infrastructure",OBSERVABILITY:"observability",SIEM:"siem",UPTIME:"uptime"};t.AlertConsumers=a;const i=Object.values(a).map((e=>e));t.validFeatureIds=i;t.isValidFeatureId=e=>"string"==typeof e&&i.includes(e);t.getSafeSortIds=e=>null==e?e:e.map((e=>null==e||""===e||e>=Number.MAX_SAFE_INTEGER?"9223372036854775807":e));t.getEsQueryConfig=e=>{const t={allowLeadingWildcards:!0,queryStringOptions:{analyze_wildcard:!0},ignoreFilterIfFieldNotInIndex:!1,dateFormatTZ:"Zulu"};if(null==e)return t;return Object.keys(e).reduce(((n,a)=>{const i=a;return null!=e[i]?{[a]:e[i],...n}:{[a]:t[i],...n}}),{})}},132:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(133),i=n(134),l=n(135),s=n(136),r=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,r=n._parentOrParents,d=n._ctorUnsubscribe,c=n._unsubscribe,u=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var m=0;m<r.length;++m){r[m].remove(this)}if(l.isFunction(c)){d&&(this._unsubscribe=void 0);try{c.call(this)}catch(e){t=e instanceof s.UnsubscriptionError?o(e.errors):[e]}}if(a.isArray(u)){m=-1;for(var p=u.length;++m<p;){var b=u[m];if(i.isObject(b))try{b.unsubscribe()}catch(e){t=t||[],e instanceof s.UnsubscriptionError?t=t.concat(o(e.errors)):t.push(e)}}}if(t)throw new s.UnsubscriptionError(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var a=n;(n=new e)._subscriptions=[a]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var l=this._subscriptions;return null===l?this._subscriptions=[n]:l.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=((t=new e).closed=!0,t),e}();function o(e){return e.reduce((function(e,t){return e.concat(t instanceof s.UnsubscriptionError?t.errors:t)}),[])}t.Subscription=r},133:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},134:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=function(e){return null!==e&&"object"==typeof e}},135:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=function(e){return"function"==typeof e}},136:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}();t.UnsubscriptionError=a},144:function(e,t,n){"use strict";n.r(t),n.d(t,"TGrid",(function(){return Ht})),n.d(t,"default",(function(){return Ht})),n.d(t,"useDraggableKeyboardWrapper",(function(){return At.a})),n.d(t,"temporarilyDisableInteractiveChildTabIndexes",(function(){return Pt.d})),n.d(t,"draggableKeyDownHandler",(function(){return Pt.b})),n.d(t,"addFieldToTimelineColumns",(function(){return Pt.a})),n.d(t,"getTimelineIdFromColumnDroppableId",(function(){return Pt.c})),n.d(t,"DragDropContextWrapper",(function(){return Tt})),n.d(t,"DraggableFieldBadge",(function(){return _t})),n.d(t,"Updated",(function(){return qt.Updated})),n.d(t,"LastUpdatedAt",(function(){return qt.LastUpdatedAt})),n.d(t,"LoadingPanel",(function(){return $t.LoadingPanel})),n.d(t,"LoadingStaticPanel",(function(){return $t.LoadingStaticPanel})),n.d(t,"LoadingStaticContentPanel",(function(){return $t.LoadingStaticContentPanel})),n.d(t,"FieldBrowserWrappedComponent",(function(){return Bt.FieldBrowserWrappedComponent}));var a=n(0),i=n.n(a),l=n(12),s=n(17),r=n(13),o=n(125),d=n(2),c=n(3),u=n(6),m=n.n(u),p=n(26),b=n(43),g=n(44),h=n(34),f=n(18),E=n(111),v=n(50),w=n.n(v),y=n(35),C=n(10),x=n(25),j=n(42),O=n(28),S=n(4);const I=S.i18n.translate("xpack.timelines.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"}),k=S.i18n.translate("xpack.timelines.timelineEvents.failSearchDescription",{defaultMessage:"Failed to run search on timeline events"}),F=[O.b.detectionsPage,O.b.detectionsRulesDetailsPage],P=e=>Object(c.isString)(e)?e:JSON.stringify(e),A=(e,t)=>{var n,a,i;return{dsl:null!==(n=null!==(a=null==e||null===(i=e.inspect)||void 0===i?void 0:i.dsl)&&void 0!==a?a:null==t?void 0:t.dsl)&&void 0!==n?n:[],response:null!=e?[JSON.stringify(e.rawResponse,null,2)]:null==t?void 0:t.response}},M=[{field:"@timestamp",direction:x.a.asc,type:"number"}],R=[],T=({alertConsumers:e=R,docValueFields:t,endDate:n,entityType:i,excludeEcsData:s=!1,id:r="timelineEventsQuery",indexNames:o,fields:d,filterQuery:u,startDate:m,language:p="kuery",limit:b,sort:h=M,skip:f=!1,timerangeKind:E,data:v})=>{const O=Object(l.useDispatch)(),S=Object(a.useRef)(c.noop),T=Object(a.useRef)(new AbortController),D=Object(a.useRef)(new y.Subscription),[N,V]=Object(a.useState)(!0),[z,L]=Object(a.useState)(0),[_,q]=Object(a.useState)(null),$=Object(a.useRef)(null),B=Object(a.useCallback)((()=>{null!=r&&F.some((e=>e===r))&&(O(C.tGridActions.clearEventsLoading({id:r})),O(C.tGridActions.clearEventsDeleted({id:r})))}),[O,r]),U=Object(a.useCallback)((e=>{B(),L(e)}),[B]),H=Object(a.useCallback)((()=>{null!=S.current&&S.current(),U(0)}),[U]),Q=Object(a.useCallback)((e=>{O(C.tGridActions.setTimelineUpdatedAt({id:r,updated:e}))}),[O,r]),[G,W]=Object(a.useState)({consumers:{},id:r,inspect:{dsl:[],response:[]},refetch:H,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:U,updatedAt:0}),{addError:K,addWarning:Z}=Object(j.a)(),J=Object(a.useCallback)((e=>{if(null==e||f)return;const t=async()=>{$.current=e,T.current=new AbortController,V(!0),v&&v.search&&(D.current=v.search.search({...e,entityType:i},{strategy:"eql"===e.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:T.current.signal}).subscribe({next:e=>{Object(g.isCompleteResponse)(e)?(W((t=>{const n={...t,consumers:e.consumers,events:(a=e.edges,a.map((e=>e.node))),inspect:A(e,t.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,updatedAt:Date.now()};var a;return Q(n.updatedAt),n})),V(!1),D.current.unsubscribe()):Object(g.isErrorResponse)(e)&&(V(!1),Z(I),D.current.unsubscribe())},error:e=>{V(!1),K(e,{title:k}),D.current.unsubscribe()}}))};D.current.unsubscribe(),T.current.abort(),t(),S.current=t}),[f,v,i,Q,Z,K]);return Object(a.useEffect)((()=>{0!==o.length&&q((a=>{var i,l,r,c,g;const f={defaultIndex:null!==(i=null==a?void 0:a.defaultIndex)&&void 0!==i?i:[],filterQuery:null!==(l=null==a?void 0:a.filterQuery)&&void 0!==l?l:"",querySize:null!==(r=null==a?void 0:a.pagination.querySize)&&void 0!==r?r:0,sort:null!==(c=null==a?void 0:a.sort)&&void 0!==c?c:M,timerange:null!==(g=null==a?void 0:a.timerange)&&void 0!==g?g:{}},E={defaultIndex:o,filterQuery:P(u),querySize:b,sort:h,timerange:{interval:"12h",from:m,to:n}},v=w()(f,E)?z:0,y={alertConsumers:e,defaultIndex:o,docValueFields:null!=t?t:[],excludeEcsData:s,factoryQueryType:x.h.all,fieldRequested:d,fields:[],filterQuery:P(u),pagination:{activePage:v,querySize:b},language:p,sort:h,timerange:{interval:"12h",from:m,to:n}};return z!==v&&L(v),w()(a,y)?a:y}))}),[e,O,o,z,t,n,s,u,r,p,b,m,h,d]),Object(a.useEffect)((()=>(w()($.current,_)||J(_),()=>{D.current.unsubscribe(),T.current.abort()})),[r,_,J,E]),Object(a.useEffect)((()=>{Object(c.isEmpty)(u)&&W({consumers:{},id:r,inspect:{dsl:[],response:[]},refetch:H,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:U,updatedAt:0})}),[u,r,H,U]),[N,G]};var D=n(113),N=n.n(D),V=n(39),z=n(48),L=n(49),_=n(47),q=n(9),$=n(109),B=n(27),U=n.n(B);const H=({ariaRowindex:e,data:t,header:n,eventId:l,linkValues:s,renderCellValue:r,tabType:o,timelineId:d})=>{const[c,u]=Object(a.useState)({});return i.a.createElement("div",U()({"data-test-subj":"statefulCell"},c),r({columnId:n.id,eventId:l,data:t,header:n,isDraggable:!0,isExpandable:!0,isExpanded:!1,isDetails:!1,linkValues:s,rowIndex:e-1,setCellProps:u,timelineId:null!=o?`${d}-${o}`:d}))};H.displayName="StatefulCellComponent";const Q=i.a.memo(H),G=({column:e,row:t})=>S.i18n.translate("xpack.timelines.timeline.youAreInATableCellScreenReaderOnly",{values:{column:e,row:t},defaultMessage:"You are in a table cell. row: {row}, column: {column}"}),W=e=>S.i18n.translate("xpack.timelines.timeline.eventHasEventRendererScreenReaderOnly",{values:{row:e},defaultMessage:"The event in row {row} has an event renderer. Press shift + down arrow to focus it."}),K=e=>{var t;const{altKey:n,ctrlKey:a,key:i,metaKey:l,shiftKey:s,target:r,type:o}=e,d=r;if((e=>{switch(e){case" ":case"Enter":return!0;default:return!1}})(i)&&null!==(t=d.className)&&void 0!==t&&t.includes($.c)){const t=d.querySelector(`.${q.a}`),r=new KeyboardEvent(o,{altKey:n,bubbles:!0,cancelable:!0,ctrlKey:a,key:i,metaKey:l,shiftKey:s});" "===i&&e.preventDefault(),null==t||t.dispatchEvent(r)}},Z=({action:e,width:t,actionsColumnWidth:n,ariaRowindex:a,columnId:l,columnValues:s,data:r,ecsData:o,eventIdToNoteIds:c,index:u,isEventPinned:m,isEventViewer:p,eventId:b,loadingEventIds:g,onEventDetailsPanelOpened:h,onRowSelected:f,rowIndex:v,hasRowRenderers:w,onRuleChange:y,selectedEventIds:C={},showCheckboxes:x,showNotes:j=!1,tabType:O,timelineId:S,toggleShowNotes:I,setEventsLoading:k,setEventsDeleted:F})=>{const P=t||n;return i.a.createElement($.f,{width:P,"data-test-subj":"event-actions-container",tabIndex:0},i.a.createElement($.d,{$ariaColumnIndex:u+E.b,key:null!=O?`${b}_${O}`:`${b}`,onKeyDown:K,role:"button",tabIndex:0,width:t},i.a.createElement($.e,{"data-test-subj":"cell-container"},i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},i.a.createElement("p",null,G({row:a,column:u+2}))),e&&i.a.createElement(e,{ariaRowindex:a,width:t,checked:Object.keys(C).includes(b),columnId:l,columnValues:s,eventId:b,data:r,ecsData:o,eventIdToNoteIds:c,index:u,isEventPinned:m,isEventViewer:p,loadingEventIds:g,onEventDetailsPanelOpened:h,onRowSelected:f,rowIndex:v,onRuleChange:y,showCheckboxes:x,showNotes:j,timelineId:S,toggleShowNotes:I,setEventsLoading:k,setEventsDeleted:F}))),w?i.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},i.a.createElement("p",null,W(a))):null))},J=({_id:e,ariaRowindex:t,index:n,header:a,data:l,ecsData:s,hasRowRenderers:r,renderCellValue:o,tabType:u,timelineId:m})=>{var p;return i.a.createElement($.d,{$ariaColumnIndex:n+E.b,key:null!=u?`${a.id}_${u}`:`${a.id}`,onKeyDown:K,role:"button",tabIndex:0,width:a.initialWidth},i.a.createElement($.e,{"data-test-subj":"cell-container"},i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},i.a.createElement("p",null,G({row:t,column:n+2}))),i.a.createElement(Q,{ariaRowindex:t,data:l,header:a,eventId:e,linkValues:Object(c.getOr)([],null!==(p=a.linkField)&&void 0!==p?p:"",s),renderCellValue:o,tabType:u,timelineId:m}))),r?i.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},i.a.createElement("p",null,W(t))):null)};i.a.memo((({ariaRowindex:e,actionsColumnWidth:t,columnHeaders:n,columnValues:l,data:s,ecsData:r,isEventViewer:o,id:d,loadingEventIds:c,onEventDetailsPanelOpened:u,onRowSelected:m,hasRowRenderers:p,onRuleChange:b,renderCellValue:g,selectedEventIds:h={},showCheckboxes:f,tabType:E,timelineId:v,trailingControlColumns:w,leadingControlColumns:y,setEventsLoading:C,setEventsDeleted:x})=>{const j=Object(a.useMemo)((()=>w?w.map((e=>e.rowCellRender)):[]),[w]),O=Object(a.useMemo)((()=>y.length+n.length),[y,n]),S=Object(a.useMemo)((()=>j.map(((n,a)=>n&&i.a.createElement(Z,{action:n,width:w[a].width,actionsColumnWidth:t,ariaRowindex:e,checked:Object.keys(h).includes(d),columnId:w[a].id||"",columnValues:l,onRowSelected:m,"data-test-subj":"actions",eventId:d,data:s,key:a,index:O+a,rowIndex:e,ecsData:r,loadingEventIds:c,onEventDetailsPanelOpened:u,showCheckboxes:f,isEventViewer:o,hasRowRenderers:p,onRuleChange:b,selectedEventIds:h,tabType:E,timelineId:v,setEventsLoading:C,setEventsDeleted:x})))),[w,d,s,r,m,o,t,e,l,p,O,c,u,b,h,f,E,v,j,C,x]),I=Object(a.useMemo)((()=>n.map(((t,n)=>i.a.createElement(J,{_id:d,index:n,header:t,key:null!=E?`${t.id}_${E}`:`${t.id}`,ariaRowindex:e,data:s,ecsData:r,hasRowRenderers:p,renderCellValue:g,tabType:E,timelineId:v})))),[d,e,n,s,r,p,g,E,v]);return i.a.createElement($.g,{"data-test-subj":"data-driven-columns"},I,S)})).displayName="DataDrivenColumns";const Y=({columnHeaders:e,controlColumn:t,data:n,disabled:s,index:o,isEventViewer:d,loadingEventIds:c,onRowSelected:u,onRuleChange:m,pageRowIndex:p,rowIndex:b,selectedEventIds:g,showCheckboxes:h,tabType:f,timelineId:E,setEventsLoading:v,setEventsDeleted:w,width:y})=>{const{data:C,ecs:x,_id:j,_index:O}=Object(a.useMemo)((()=>{const e=n[p];return null!=e?e:{}}),[n,p]),S=Object(l.useDispatch)(),I=Object(a.useMemo)((()=>C&&e.map((e=>{var t;return null!==(t=(({data:e,fieldName:t})=>{const n=e.find((e=>e.field===t));if(null!=n&&null!=n.value)return n.value})({data:C,fieldName:e.id}))&&void 0!==t?t:[]})).join(" ")),[e,C]),k=Object(a.useCallback)((()=>{const e={panelView:"eventDetail",params:{eventId:null!=j?j:"",indexName:null!=O?O:"",ecsData:x}};S(r.c.toggleDetailPanel({...e,tabType:f,timelineId:E}))}),[S,x,j,O,f,E]),F=t.rowCellRender;return C&&x&&j?i.a.createElement(i.a.Fragment,null,F&&i.a.createElement(F,{ariaRowindex:p+1,checked:Object.keys(g).includes(j),columnId:t.id||"",columnValues:I||"",data:C,"data-test-subj":"actions",disabled:s,ecsData:x,eventId:j,index:o,isEventViewer:d,loadingEventIds:c,onEventDetailsPanelOpened:k,onRowSelected:u,onRuleChange:m,rowIndex:b,showCheckboxes:h,tabType:f,timelineId:E,width:y,setEventsLoading:v,setEventsDeleted:w})):i.a.createElement("span",{"data-test-subj":"noData"})},X=i.a.memo(Y);var ee=n(114);const te=({ariaRowindex:e,columnValues:t,checked:n})=>S.i18n.translate("xpack.timelines.timeline.body.actions.checkboxForRowAriaLabel",{values:{ariaRowindex:e,checked:n,columnValues:t},defaultMessage:"{checked, select, false {unchecked} true {checked}} checkbox for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),ne={id:"checkbox-control-column",width:32,headerCellRender:({onSelectAll:e,isSelectAllChecked:t})=>{const n=Object(a.useCallback)((t=>{e({isSelected:t.currentTarget.checked})}),[e]);return i.a.createElement(d.EuiCheckbox,{"data-test-subj":"select-all-events",id:"select-all-events",checked:t,onChange:n})},rowCellRender:({eventId:e,onRowSelected:t,checked:n,ariaRowindex:l,columnValues:s,disabled:r,loadingEventIds:o})=>{const c=Object(a.useCallback)((n=>{r||t({eventIds:[e],isSelected:n.currentTarget.checked})}),[e,t,r]);return o.includes(e)?i.a.createElement(d.EuiLoadingSpinner,{size:"m","data-test-subj":"event-loader"}):i.a.createElement(d.EuiCheckbox,{"data-test-subj":"select-event",id:e,checked:n&&!r,disabled:r,onChange:c,"aria-label":te({ariaRowindex:l,columnValues:s,checked:n})})}};var ae=n(22),ie=n(100),le=n.n(ie);const se=e=>Object(ae.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`,re=({name:e,id:t})=>{const{navigateToApp:n,getUrlForApp:l}=Object(p.useKibana)().services.application,s=Object(a.useMemo)((()=>l("securitySolution",{deepLinkId:"rules",path:`/id/${t}${se(window.location.search)}`})),[l,t]),r=Object(a.useCallback)((e=>{e.preventDefault(),n("securitySolution",{deepLinkId:"rules",path:`/id/${t}${se(window.location.search)}`})}),[n,t]);return i.a.createElement(d.EuiLink,{href:s,onClick:r},e)},oe=i.a.memo(re),de=m()(d.EuiFlexItem).withConfig({displayName:"EventRenderedFlexItem",componentId:"sc-o4qyf6-0"})(["div:first-child{padding-left:0px;div{margin:0px;}}"]),ce=m.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-o4qyf6-1"})(["display:flex;align-items:center;div div:first-child div.siemEventsTable__tdContent{margin-left:",";}"],(({theme:e})=>e.eui.paddingSizes.m)),ue=m()(d.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-o4qyf6-2"})(["padding-top:",";.EventRenderedView__buildingBlock{background:",";}& > div:last-child{height:72px;}"],(({theme:e})=>e.eui.paddingSizes.m),(({theme:e})=>e.eui.euiColorHighlight)),me=({value:e})=>{var t,n;const a=Object(p.useUiSetting)("dateFormat:tz"),l=Object(p.useUiSetting)("dateFormat"),s=null!==(t=null===(n=le.a.tz.zone(a))||void 0===n?void 0:n.name)&&void 0!==t?t:le.a.tz.guess();return i.a.createElement("span",{"data-test-subj":"moment-date"},le.a.tz(e,s).format(l))},pe=i.a.memo(me),be=({alertToolbar:e,browserFields:t,events:n,leadingControlColumns:l,onChangePage:s,onChangeItemsPerPage:r,pageIndex:o,pageSize:c,pageSizeOptions:u,rowRenderers:m,totalItemCount:p})=>{const b=Object(a.useMemo)((()=>i.a.createElement(d.EuiFlexGroup,{gutterSize:"m"},l.map((e=>{const t=e.headerCellRender;return i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(t,null))})))),[l]),g=Object(a.useMemo)((()=>[{field:"actions",name:b,truncateText:!1,hideForMobile:!1,render:(e,t)=>{const a=Object(ae.get)(t,"_id"),s=n.findIndex((e=>e._id===a));return i.a.createElement(ce,null,l.length>0?l.map((e=>(0,e.rowCellRender)({columnId:"actions",isDetails:!1,isExpandable:!1,isExpanded:!1,rowIndex:s,setCellProps:()=>null}))):null)},width:"152px"},{field:"ecs.timestamp",name:S.i18n.translate("xpack.timelines.alerts.EventRenderedView.timestamp.column",{defaultMessage:"Timestamp"}),truncateText:!1,hideForMobile:!1,render:(e,t)=>{const n=Object(ae.get)(t,"ecs.timestamp");return i.a.createElement(pe,{value:n})}},{field:`ecs.${V.ALERT_RULE_NAME}`,name:S.i18n.translate("xpack.timelines.alerts.EventRenderedView.rule.column",{defaultMessage:"Rule"}),truncateText:!1,hideForMobile:!1,render:(e,t)=>{const n=Object(ae.get)(t,"ecs.signal.rule.name"),a=Object(ae.get)(t,"ecs.signal.rule.id");return i.a.createElement(oe,{name:n,id:a})}},{field:"eventSummary",name:S.i18n.translate("xpack.timelines.alerts.EventRenderedView.eventSummary.column",{defaultMessage:"Event Summary"}),truncateText:!1,hideForMobile:!1,render:(e,n)=>{const a=Object(ae.get)(n,"ecs"),l=Object(ae.get)(n,"ecs.signal.reason"),s=m.filter((e=>e.isInstance(a)));return i.a.createElement(d.EuiFlexGroup,{gutterSize:"none",direction:"column",className:"eui-fullWidth"},l&&i.a.createElement(d.EuiFlexItem,null,l),s.length>0&&s.map((e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiHorizontalRule,{size:"half",margin:"xs"}),i.a.createElement(de,{className:"eui-xScroll"},i.a.createElement("div",{className:"eui-displayInlineBlock"},e.renderRow({browserFields:t,data:a,isDraggable:!1,timelineId:"NONE"})))))))},width:"60%"}]),[b,t,n,l,m]),h=Object(a.useCallback)((e=>{e.page.index!==o&&s(e.page.index),e.page.size!==c&&r(e.page.size)}),[s,o,c,r]),f=Object(a.useMemo)((()=>({pageIndex:o,pageSize:c,totalItemCount:p,pageSizeOptions:u,hidePerPageOptions:!1})),[o,c,u,p]);return i.a.createElement(i.a.Fragment,null,e,i.a.createElement(ue,{compressed:!0,items:n,columns:g,"data-test-subj":"event-rendered-view",pagination:f,onChange:h,rowProps:({ecs:e})=>Object(L.e)(e)?{className:"EventRenderedView__buildingBlock"}:{}}))},ge=i.a.memo(be),he={10:457,25:967,50:1817,100:3517},fe=(S.i18n.translate("xpack.timelines.timeline.categoryTooltip",{defaultMessage:"Category"}),S.i18n.translate("xpack.timelines.timeline.descriptionTooltip",{defaultMessage:"Description"}),S.i18n.translate("xpack.timelines.timeline.fieldTooltip",{defaultMessage:"Field"}),S.i18n.translate("xpack.timelines.timeline.fullScreenButton",{defaultMessage:"Full screen"}),S.i18n.translate("xpack.timelines.timeline.sortAZLabel",{defaultMessage:"Sort A-Z"}),S.i18n.translate("xpack.timelines.timeline.sortFieldsButton",{defaultMessage:"Sort fields"}),S.i18n.translate("xpack.timelines.timeline.sortZALabel",{defaultMessage:"Sort Z-A"}),S.i18n.translate("xpack.timelines.timeline.typeTooltip",{defaultMessage:"Type"}),S.i18n.translate("xpack.timelines.timeline.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"})),Ee=Object(a.lazy)((()=>n.e(16).then(n.bind(null,146)))),ve=e=>ee.a(e),we=[],ye=()=>null,Ce={border:"none",fontSize:"s",header:"underline"},xe=m.a.div.withConfig({displayName:"EuiDataGridContainer",componentId:"sc-1q4165e-0"})(["ul.euiPagination__list{li.euiPagination__item:last-child{",";}}"],(({hideLastPage:e})=>""+(e?"display:none":""))),je=i.a.memo((({activePage:e,additionalControls:t,browserFields:n,bulkActions:s=!0,clearSelected:o,columnHeaders:m,data:p,defaultCellActions:b,disabledCellActions:g,filterQuery:f,filters:E,filterStatus:v,hasAlertsCrud:w,hasAlertsCrudPermissions:y,id:x,indexNames:j,isEventViewer:O=!1,isLoading:S,isSelectAllChecked:I,itemsPerPageOptions:k,leadingControlColumns:F=we,loadingEventIds:P,loadPage:A,onRuleChange:M,pageSize:R,refetch:T,renderCellValue:D,rowRenderers:N,selectedEventIds:z,setSelected:q,showCheckboxes:B,sort:U,tableView:H="gridView",tabType:Q,totalItems:G,totalSelectAllAlerts:W,trailingControlColumns:K=we,unit:Z=ve})=>{const J=Object(l.useDispatch)(),Y=Object(a.useMemo)((()=>r.d.getManageTimelineById()),[]),{queryFields:te,selectAll:ae}=Object(h.a)((e=>Y(e,x))),ie=Object(a.useMemo)((()=>`${G.toLocaleString()} ${Z(G)}`),[G,Z]),le=Object(a.useMemo)((()=>Object.keys(z).length),[z]),se=Object(a.useContext)(u.ThemeContext),re=Object(a.useCallback)((({eventIds:e,isSelected:t})=>{q({id:x,eventIds:Object(L.c)(p,e,te,null!=w&&w,y),isSelected:t,isSelectAllChecked:t&&le+1===p.length})}),[q,x,p,te,w,y,le]),oe=Object(a.useCallback)((({isSelected:e})=>e?q({id:x,eventIds:Object(L.c)(p,p.map((e=>e._id)),te,null!=w&&w,y),isSelected:e,isSelectAllChecked:e}):o({id:x})),[q,x,p,te,w,y,o]);Object(a.useEffect)((()=>{ae&&!I&&oe({isSelected:!0})}),[I,oe,ae]);const de=Object(a.useMemo)((()=>{if(s&&!0!==s)return s.onAlertStatusActionSuccess}),[s]),ce=Object(a.useMemo)((()=>{if(s&&!0!==s)return s.onAlertStatusActionFailure}),[s]),ue=Object(a.useMemo)((()=>{var e;return!!w&&(!(0===le||!B)&&("boolean"==typeof s?s:null===(e=s.alertStatusActions)||void 0===e||e))}),[w,le,B,s]),me=Object(a.useMemo)((()=>i.a.createElement(d.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement($.a,null,ie)),ue&&i.a.createElement(a.Suspense,{fallback:i.a.createElement(d.EuiLoadingSpinner,null)},i.a.createElement(Ee,{"data-test-subj":"bulk-actions",id:x,totalItems:null!=W?W:G,filterStatus:v,query:f,indexName:j.join(),onActionSuccess:de,onActionFailure:ce,refetch:T})))),[ie,f,v,x,j,ce,de,T,ue,G,W]),pe=Object(a.useMemo)((()=>({additionalControls:i.a.createElement(i.a.Fragment,null,S&&i.a.createElement(d.EuiProgress,{size:"xs",position:"absolute",color:"accent"}),i.a.createElement($.a,{"data-test-subj":"server-side-event-count"},ie),ue?i.a.createElement(i.a.Fragment,null,i.a.createElement(a.Suspense,{fallback:i.a.createElement(d.EuiLoadingSpinner,null)},i.a.createElement(Ee,{"data-test-subj":"bulk-actions",id:x,totalItems:null!=W?W:G,filterStatus:v,query:f,indexName:j.join(),onActionSuccess:de,onActionFailure:ce,refetch:T})),null!=t?t:null):i.a.createElement(i.a.Fragment,null,null!=t?t:null,i.a.createElement(C.StatefulFieldsBrowser,{"data-test-subj":"field-browser",browserFields:n,timelineId:x,columnHeaders:m}))),...ue?{showColumnSelector:!1,showSortSelector:!1,showFullScreenSelector:!1}:{showColumnSelector:{allowHide:!1,allowReorder:!0},showSortSelector:!0,showFullScreenSelector:!0},showStyleSelector:!1})),[ie,ue,x,W,G,v,f,j,de,ce,T,S,t,n,m]),be=Object(a.useMemo)((()=>U.map((e=>({id:e.columnId,direction:Object(L.f)(e.sortDirection)})))),[U]),je=Object(a.useCallback)((e=>{J(r.c.updateSort({id:x,sort:Object(L.g)({columns:e,columnHeaders:m})})),setTimeout((()=>{null!=A&&A(0)}),0)}),[m,J,x,A]),Oe=Object(a.useMemo)((()=>m.map((({id:e})=>e))),[m]),Se=Object(a.useCallback)((({columnId:e,width:t})=>{J(r.c.updateColumnWidth({columnId:e,id:x,width:t}))}),[J,x]),Ie=Object(a.useCallback)((e=>{J(r.c.updateColumnOrder({columnIds:e,id:x}))}),[J,x]),ke=Object(a.useCallback)((({eventIds:e,isLoading:t})=>{J(r.c.setEventsLoading({id:x,eventIds:e,isLoading:t}))}),[J,x]),Fe=Object(a.useCallback)((({eventIds:e,isDeleted:t})=>{J(r.c.setEventsDeleted({id:x,eventIds:e,isDeleted:t}))}),[J,x]),[Pe,Ae]=Object(a.useMemo)((()=>[B?[ne,...F]:F,K].map((e=>(({columnHeaders:e,controlColumns:t,data:n,isEventViewer:a=!1,loadingEventIds:l,onRowSelected:s,onRuleChange:r,selectedEventIds:o,showCheckboxes:d,tabType:c,timelineId:u,isSelectAllChecked:m,onSelectPage:p,browserFields:b,pageSize:g,sort:h,theme:f,setEventsLoading:E,setEventsDeleted:v,hasAlertsCrudPermissions:w})=>t.map((({id:y,headerCellRender:C=ye,rowCellRender:x,width:j},O)=>({id:`${y}`,headerCellRender:()=>{const t=C;return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(t,{width:j,browserFields:b,columnHeaders:e,isEventViewer:a,isSelectAllChecked:m,onSelectAll:p,showEventsSelect:!1,showSelectAllCheckbox:d,sort:h,tabType:c,timelineId:u}))},rowCellRender:({isDetails:m,isExpandable:p,isExpanded:b,rowIndex:h,setCellProps:C})=>{const x=Object(_.a)(h,g),S=n[x];let I=!1;if(S){if(Object(L.a)(S.ecs,f,C),"checkbox-control-column"===y&&null!=w){var k,F,P,A;const e=null!==(k=null===(F=S.data.find((e=>e.field===V.ALERT_RULE_CONSUMER)))||void 0===F?void 0:F.value)&&void 0!==k?k:[],t=null!==(P=null===(A=S.data.find((e=>e.field===V.ALERT_RULE_PRODUCER)))||void 0===A?void 0:A.value)&&void 0!==P?P:[];I=!w({ruleConsumer:e.length>0?e[0]:"",ruleProducer:t.length>0?t[0]:void 0})}}else C({style:{display:"none"}});return i.a.createElement(X,{columnId:null!=y?y:"",columnHeaders:e,controlColumn:t[O],data:n,disabled:I,index:O,isDetails:m,isExpanded:b,isEventViewer:a,isExpandable:p,loadingEventIds:l,onRowSelected:s,onRuleChange:r,rowIndex:h,pageRowIndex:x,selectedEventIds:o,setCellProps:C,showCheckboxes:d,tabType:c,timelineId:u,width:j,setEventsLoading:E,setEventsDeleted:v})},width:j}))))({columnHeaders:m,controlColumns:e,data:p,disabledCellActions:g,isEventViewer:O,loadingEventIds:P,onRowSelected:re,onRuleChange:M,selectedEventIds:z,showCheckboxes:B,tabType:Q,timelineId:x,isSelectAllChecked:I,sort:U,browserFields:n,onSelectPage:oe,theme:se,setEventsLoading:ke,setEventsDeleted:Fe,pageSize:R,hasAlertsCrudPermissions:y})))),[B,F,K,m,p,g,O,x,P,re,M,z,Q,I,U,n,oe,se,R,ke,Fe,y]),Me=Object(a.useMemo)((()=>m.map((e=>{var t,a;const i=t=>t({browserFields:n,data:p.map((e=>e.data)),ecsData:p.map((e=>e.ecs)),header:m.find((t=>t.id===e.id)),pageSize:R,timelineId:x});return{...e,actions:{...e.actions,additional:[{iconType:"cross",label:fe,onClick:()=>{J(r.c.removeColumn({id:x,columnId:e.id}))},size:"xs"}]},...Object(L.d)({columnId:e.id,disabledCellActions:g})?{cellActions:null!==(t=null===(a=e.tGridCellActions)||void 0===a?void 0:a.map(i))&&void 0!==t?t:null==b?void 0:b.map(i)}:{}}}))),[n,m,p,b,g,J,x,R]),Re=Object(a.useMemo)((()=>({columnId:e,rowIndex:t,setCellProps:i,isDetails:l})=>{var s;const r=Object(_.a)(t,R),o=r<p.length?p[r].data:null,d=m.find((t=>t.id===e)),u=r<p.length?p[r]._id:null,b=r<p.length?p[r].ecs:null;return Object(a.useEffect)((()=>{const e={overflow:"hidden"};i({style:{...e}}),b&&o?Object(L.a)(b,se,i,e):i({style:{display:"none"}})}),[t,i,b,o]),null==o||null==d||null==u||null===b?null:D({browserFields:n,columnId:d.id,data:o,ecsData:b,eventId:u,globalFilters:E,header:d,isDetails:l,isDraggable:!1,isExpandable:!0,isExpanded:!1,linkValues:Object(c.getOr)([],null!==(s=d.linkField)&&void 0!==s?s:"",b),rowIndex:t,rowRenderers:N,setCellProps:i,timelineId:x,truncate:!l})}),[n,m,p,E,x,R,D,N,se]),Te=Object(a.useCallback)((e=>{J(r.c.updateItemsPerPage({id:x,itemsPerPage:e}))}),[x,J]),De=Object(a.useCallback)((e=>{A(e)}),[A]),Ne=((e,t)=>{const[n,i]=Object(a.useState)(he[e]);return Object(a.useLayoutEffect)((()=>{setTimeout((()=>{const n=document.querySelector("#body-data-grid .euiDataGrid__virtualized");t===e?i(he[e]):t<=e?i(36*t+76):n&&n.children[0].clientHeight!==n.clientHeight&&i((e=>e+n.children[0].clientHeight-n.clientHeight+3))}),50)}),[e,t]),n})(R,p.length),[Ve]=Object(a.useState)({timelineID:x,tabType:Q,enableHostDetailsFlyout:!0,enableIpDetailsFlyout:!0});return i.a.createElement(i.a.Fragment,null,i.a.createElement(C.StatefulEventContext.Provider,{value:Ve},"gridView"===H&&i.a.createElement(xe,{hideLastPage:G>9999},i.a.createElement(d.EuiDataGrid,{height:Ne,id:"body-data-grid","data-test-subj":"body-data-grid","aria-label":ee.c,columns:Me,columnVisibility:{visibleColumns:Oe,setVisibleColumns:Ie},gridStyle:Ce,leadingControlColumns:Pe,trailingControlColumns:Ae,toolbarVisibility:pe,rowCount:G,renderCellValue:Re,sorting:{columns:be,onSort:je},onColumnResize:Se,pagination:{pageIndex:e,pageSize:R,pageSizeOptions:k,onChangeItemsPerPage:Te,onChangePage:De}})),"eventRenderedView"===H&&i.a.createElement(ge,{alertToolbar:me,browserFields:n,events:p,leadingControlColumns:null!=Pe?Pe:[],onChangePage:De,onChangeItemsPerPage:Te,pageIndex:e,pageSize:R,pageSizeOptions:k,rowRenderers:N,totalItemCount:G})))}));je.displayName="BodyComponent";const Oe={clearSelected:r.c.clearSelected,setSelected:r.c.setSelected},Se=Object(l.connect)((()=>{const e=N()(z.b),t=r.d.getTGridByIdSelector();return(n,{browserFields:a,id:i,hasAlertsCrud:l})=>{const s=t(n,i),{columns:r,excludedRowRendererIds:o,isSelectAllChecked:d,loadingEventIds:c,selectedEventIds:u,showCheckboxes:m,sort:p,isLoading:b}=s;return{columnHeaders:e(r,a),excludedRowRendererIds:o,isSelectAllChecked:d,loadingEventIds:c,isLoading:b,id:i,selectedEventIds:u,showCheckboxes:!0===l&&m,sort:p}}}),Oe)(je);var Ie=n(97),ke=n.n(Ie);const Fe=S.i18n.translate("xpack.timelines.inspectDescription",{defaultMessage:"Inspect"}),Pe=S.i18n.translate("xpack.timelines.inspect.modal.closeTitle",{defaultMessage:"Close"}),Ae=S.i18n.translate("xpack.timelines.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),Me=S.i18n.translate("xpack.timelines.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),Re=S.i18n.translate("xpack.timelines.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),Te=S.i18n.translate("xpack.timelines.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),De=S.i18n.translate("xpack.timelines.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),Ne=S.i18n.translate("xpack.timelines.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),Ve=S.i18n.translate("xpack.timelines.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),ze=S.i18n.translate("xpack.timelines.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"}),Le="no-alert-index-049FC71A-4C2C-446F-9901-37XMC5024C51",_e=m()(d.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-mek2gz-0"})(["@media only screen and (min-width:","){.euiDescriptionList__title{width:30% !important;}.euiDescriptionList__description{width:70% !important;}}"],(e=>{var t,n,a,i;return null!==(t=null==e||null===(n=e.theme)||void 0===n||null===(a=n.eui)||void 0===a||null===(i=a.euiBreakpoints)||void 0===i?void 0:i.s)&&void 0!==t?t:"600px"}));_e.displayName="DescriptionListStyled";const qe=m()(d.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-mek2gz-1"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]);qe.displayName="MyEuiModal";const $e=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},Be=(e=[])=>1===e.length&&e[0]===Le?i.a.createElement("i",null,ze):e.length>0?e.filter((e=>e!==Le)).join(", "):Ae,Ue=({closeModal:e,isShowing:t=!1,request:n,response:l,additionalRequests:s,additionalResponses:r,title:o})=>{var c,u,m;if(!t||null==n||null==l)return null;const p=[n,...null!=s?s:[]],b=[l,...null!=r?r:[]],g=$e(p),h=$e(b),f=[{title:i.a.createElement("span",{"data-test-subj":"index-pattern-title"},Me," ",i.a.createElement(d.EuiIconTip,{color:"subdued",content:Re,type:"iInCircle"})),description:i.a.createElement("span",{"data-test-subj":"index-pattern-description"},Be(null!==(c=null===(u=g[0])||void 0===u?void 0:u.index)&&void 0!==c?c:[]))},{title:i.a.createElement("span",{"data-test-subj":"query-time-title"},Te," ",i.a.createElement(d.EuiIconTip,{color:"subdued",content:De,type:"iInCircle"})),description:i.a.createElement("span",{"data-test-subj":"query-time-description"},null!==(m=h[0])&&void 0!==m&&m.took?`${ke()(h[0].took).format("0,0")}ms`:Ae)},{title:i.a.createElement("span",{"data-test-subj":"request-timestamp-title"},Ne," ",i.a.createElement(d.EuiIconTip,{color:"subdued",content:Ve,type:"iInCircle"})),description:i.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}],E=[{id:"statistics",name:"Statistics",content:i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,null),i.a.createElement(_e,{listItems:f,type:"column"}))},{id:"request",name:"Request",content:g.length>0?g.map(((e,t)=>i.a.createElement(a.Fragment,{key:t},i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return Ae}})(e.body))))):i.a.createElement(d.EuiCodeBlock,null,Ae)},{id:"response",name:"Response",content:h.length>0?b.map(((e,t)=>i.a.createElement(a.Fragment,{key:t},i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},e)))):i.a.createElement(d.EuiCodeBlock,null,Ae)}];return i.a.createElement(qe,{onClose:e,"data-test-subj":"modal-inspect-euiModal"},i.a.createElement(d.EuiModalHeader,null,i.a.createElement(d.EuiModalHeaderTitle,null,Fe," ",o)),i.a.createElement(d.EuiModalBody,null,i.a.createElement(d.EuiTabbedContent,{tabs:E,initialSelectedTab:E[0],autoFocus:"selected"})),i.a.createElement(d.EuiModalFooter,null,i.a.createElement(d.EuiButton,{onClick:e,fill:!0,"data-test-subj":"modal-inspect-close"},Pe)))},He="inspectButtonComponent",Qe=m.a.div.withConfig({displayName:"InspectButtonContainer",componentId:"sc-16hfz2f-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}.","{pointer-events:none;opacity:0;transition:opacity "," ease;}",""],He,(e=>Object(c.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),(({show:e})=>e&&Object(u.css)(["&:hover .","{pointer-events:auto;opacity:1;}"],He)));Qe.displayName="InspectButtonContainer",Qe.defaultProps={show:!0};const Ge=({inspect:e,isDisabled:t,loading:n,onCloseInspect:l,title:s=""})=>{const[r,o]=Object(a.useState)(!1),c=!n&&r,u=Object(a.useCallback)((()=>{o(!0)}),[]),m=Object(a.useCallback)((()=>{null!=l&&l(),o(!1)}),[l,o]);let p=null;null!=e&&e.dsl.length>0&&(p=e.dsl[0]);let b=null;return null!=e&&e.response.length>0&&(b=e.response[0]),i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiButtonIcon,{className:He,"aria-label":Fe,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:n||t||!1,title:Fe,onClick:u}),i.a.createElement(Ue,{closeModal:m,isShowing:c,request:p,response:b,title:s,"data-test-subj":"inspect-modal"}))},We=i.a.memo(Ge),Ke=m.a.div.withConfig({displayName:"ContainerEuiSelectable",componentId:"sc-etesyi-0"})(["width:300px;.euiSelectableListItem__text{white-space:pre-wrap !important;line-height:normal;}"]),Ze=S.i18n.translate("xpack.timelines.alerts.summaryView.gridView.label",{defaultMessage:"Grid view"}),Je=S.i18n.translate("xpack.timelines.alerts.summaryView.eventRendererView.label",{defaultMessage:"Event rendered view"}),Ye=({viewSelected:e,onViewChange:t})=>{const[n,l]=Object(a.useState)(!1),s=Object(a.useCallback)((()=>l((e=>!e))),[]),r=Object(a.useCallback)((()=>l(!1)),[]),o=Object(a.useCallback)((e=>{const n=e.filter((e=>"on"===e.checked));var a,i;n.length>0&&t(null!==(a=null===(i=n[0])||void 0===i?void 0:i.key)&&void 0!==a?a:"gridView");l(!1)}),[t]),c=Object(a.useMemo)((()=>i.a.createElement(d.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",iconSize:"s",onClick:s,size:"xs",flush:"both",style:{fontWeight:"normal"}},"gridView"===e?Ze:Je)),[s,e]),u=Object(a.useMemo)((()=>[{label:Ze,key:"gridView",checked:"gridView"===e?"on":void 0,meta:[{text:S.i18n.translate("xpack.timelines.alerts.summaryView.options.default.description",{defaultMessage:"View as tabular data with the ability to group and sort by specific fields"})}]},{label:Je,key:"eventRenderedView",checked:"eventRenderedView"===e?"on":void 0,meta:[{text:S.i18n.translate("xpack.timelines.alerts.summaryView.options.summaryView.description",{defaultMessage:"View a rendering of the event flow for each alert"})}]}]),[e]),m=Object(a.useCallback)((e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"xxs"},i.a.createElement("h6",null,e.label)),i.a.createElement(d.EuiTextColor,{color:"subdued"},i.a.createElement("small",null,e.meta[0].text)))),[]),p=Object(a.useMemo)((()=>({rowHeight:80,showIcons:!0})),[]);return i.a.createElement(d.EuiPopover,{panelPaddingSize:"none",button:c,isOpen:n,closePopover:r},i.a.createElement(Ke,null,i.a.createElement(d.EuiSelectable,{options:u,onChange:o,renderOption:m,searchable:!1,height:160,listProps:p,singleSelection:!0},(e=>e))))},Xe=i.a.memo(Ye);var et=n(36);const tt=m.a.span.withConfig({displayName:"TitleText",componentId:"sc-17dw9c-0"})(["margin-right:12px;"]),nt=m()(d.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-17dw9c-1"})(["display:flex;flex-direction:column;position:relative;",""],(({$isFullScreen:e})=>e&&"\n      border: 0;\n      box-shadow: none;\n      padding-top: 0;\n      padding-bottom: 0;\n  ")),at=m.a.div.attrs((({className:e=""})=>({className:`${$.i} ${e}`}))).withConfig({displayName:"EventsContainerLoading",componentId:"sc-17dw9c-2"})(["position:relative;width:100%;overflow:hidden;flex:1;display:flex;flex-direction:column;"]),it=m()(d.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-17dw9c-3"})(["overflow:hidden;margin:0;display:",";"],(({$visible:e})=>e?"flex":"none")),lt=m()(d.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-17dw9c-4"})(["overflow:auto;"]),st=[o.AlertConsumers.SIEM],rt=({additionalFilters:e,browserFields:t,bulkActions:n=!0,columns:s,data:o,dataProviders:d,defaultCellActions:u,deletedEventIds:m,disabledCellActions:v,docValueFields:w,end:y,entityType:C,filters:x,filterStatus:j,globalFullScreen:O,graphEventId:S,graphOverlay:I=null,hasAlertsCrud:k,id:F,indexNames:P,indexPattern:A,isLoadingIndexPattern:M,itemsPerPage:R,itemsPerPageOptions:D,kqlMode:N,leadingControlColumns:V,onRuleChange:z,query:L,renderCellValue:_,rowRenderers:q,setQuery:B,sort:U,start:H,tGridEventRenderedViewEnabled:Q,trailingControlColumns:G,unit:W})=>{const K=Object(l.useDispatch)(),Z=Object(c.isEmpty)(s)?f.c:s,{uiSettings:J}=Object(p.useKibana)().services,[Y,X]=Object(a.useState)(!0),[ee,te]=Object(a.useState)("gridView"),ne=Object(a.useMemo)((()=>r.d.getManageTimelineById()),[]),{queryFields:ae,title:ie}=Object(h.a)((e=>ne(e,null!=F?F:"")));Object(a.useEffect)((()=>{K(r.c.updateIsLoading({id:F,isLoading:Y}))}),[K,F,Y]);const le=Object(a.useMemo)((()=>i.a.createElement(tt,{"data-test-subj":"title"},ie)),[ie]),se=Object(E.c)({config:g.esQuery.getEsQueryConfig(J),dataProviders:d,indexPattern:A,browserFields:t,filters:x,kqlQuery:L,kqlMode:N,isEventViewer:!0}),re=Object(a.useMemo)((()=>null!=se&&null!=M&&!M&&!Object(c.isEmpty)(H)&&!Object(c.isEmpty)(y)),[M,se,H,y]),oe=Object(a.useMemo)((()=>[...Z.map((e=>e.id)),...null!=ae?ae:[]]),[Z,ae]),de=Object(a.useMemo)((()=>U.map((({columnId:e,columnType:t,sortDirection:n})=>({field:e,type:t,direction:n})))),[U]),[ce,{events:ue,loadPage:me,pageInfo:pe,refetch:be,totalCount:ge=0,inspect:he}]=T({alertConsumers:st,data:o,docValueFields:w,endDate:y,entityType:C,fields:oe,filterQuery:null==se?void 0:se.filterQuery,id:F,indexNames:P,limit:R,skip:!re,sort:de,startDate:H}),fe=Object(a.useMemo)((()=>Object(E.e)({config:g.esQuery.getEsQueryConfig(J),browserFields:t,dataProviders:d,filters:x,from:H,indexPattern:A,isEventViewer:!0,kqlMode:N,kqlQuery:L,to:y})),[J,d,A,t,x,H,y,L,N]),Ee=Object(a.useMemo)((()=>ge>0?ge-m.length:0),[m.length,ge]),ve=Ee>0,we=Object(a.useMemo)((()=>ue.filter((e=>!m.includes(e._id)))),[m,ue]);Object(a.useEffect)((()=>{X(ce)}),[ce]);const ye="gridView"===ee?"baseline":"center",Ce=Object(a.useRef)(!0);Object(a.useEffect)((()=>{Ce.current&&!ce&&(Ce.current=!1)}),[ce]),Object(a.useEffect)((()=>{B(he,ce,be)}),[he,ce,be,B]);const xe=Object(a.useMemo)((()=>({timelineId:F})),[F]);return Object(a.useEffect)((()=>{K(r.c.clearSelected({id:F})),K(r.c.setTGridSelectAll({id:F,selectAll:!1}))}),[we,K,F]),i.a.createElement(Qe,null,i.a.createElement(nt,{hasBorder:!1,hasShadow:!1,paddingSize:"none","data-test-subj":"events-viewer-panel",$isFullScreen:O},Ce.current&&i.a.createElement(et.b,{height:"short"}),I,re&&i.a.createElement(et.c.Provider,{value:xe},i.a.createElement(at,{"data-timeline-id":F,"data-test-subj":`events-container-loading-${ce}`},i.a.createElement($.j,{gutterSize:"m",justifyContent:"flexEnd",alignItems:ye},i.a.createElement($.k,{grow:!1,$show:!ce},i.a.createElement(We,{title:le,inspect:he,loading:ce})),i.a.createElement($.k,{grow:!1,$show:!ce},!Object(E.f)(S)&&e),Q&&["detections-page","detections-rules-details-page"].includes(F)&&i.a.createElement($.k,{grow:!1,$show:!ce},i.a.createElement(Xe,{viewSelected:ee,onViewChange:te}))),!S&&null==I&&i.a.createElement(i.a.Fragment,null,!ve&&!ce&&i.a.createElement(et.a,{height:"short"}),ve&&i.a.createElement(it,{$visible:!S&&null==I,gutterSize:"none"},i.a.createElement(lt,{grow:1},i.a.createElement(Se,{activePage:pe.activePage,browserFields:t,bulkActions:n,data:we,defaultCellActions:u,disabledCellActions:v,filterQuery:fe,filters:x,filterStatus:j,hasAlertsCrud:k,id:F,indexNames:P,isEventViewer:!0,itemsPerPageOptions:D,leadingControlColumns:V,loadPage:me,onRuleChange:z,pageSize:R,refetch:be,renderCellValue:_,rowRenderers:q,tableView:ee,tabType:b.v.query,totalItems:Ee,trailingControlColumns:G,unit:W}))))))))},ot=i.a.memo(rt);var dt=n(132);const ct=S.i18n.translate("xpack.timelines.beatFields.errorSearchDescription",{defaultMessage:"An error has occurred on getting beat fields"}),ut=S.i18n.translate("xpack.timelines.beatFields.failSearchDescription",{defaultMessage:"Failed to run search on beat fields"}),mt={},pt={fields:[],title:""},bt=[],gt=N()(((e,t)=>t.reduce(((e,t)=>(null==e[t.category]&&(e[t.category]={}),null==e[t.category].fields&&(e[t.category].fields={}),e[t.category].fields[t.name]=t,e)),{})),((e,t)=>e[0]===t[0])),ht=N()(((e,t)=>t&&t.length>0?t.reduce(((e,t)=>t.readFromDocValues&&e.length<100?[...e,{field:t.name,format:t.format?t.format:void 0}]:e),[]):[]),((e,t)=>e[0]===t[0])),ft=N()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(c.pick)(["name","searchable","type","aggregatable","esTypes","subType"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length));var Et=n(124);const vt="standalone-t-grid",wt=[],yt=m.a.span.withConfig({displayName:"TitleText",componentId:"sc-15ctj45-0"})(["margin-right:12px;"]),Ct=m.a.div.withConfig({displayName:"AlertsTableWrapper",componentId:"sc-15ctj45-1"})(["width:100%;height:100%;"]),xt=m.a.div.attrs((({className:e=""})=>({className:`${$.i} ${e}`}))).withConfig({displayName:"EventsContainerLoading",componentId:"sc-15ctj45-2"})(["position:relative;width:100%;overflow:hidden;flex:1;display:flex;flex-direction:column;"]),jt=m()(d.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-15ctj45-3"})(["overflow:auto;"]),Ot=({afterCaseSelection:e,appId:t,casePermissions:n,columns:s,defaultCellActions:o,deletedEventIds:d,disabledCellActions:u,end:m,entityType:v="alerts",loadingText:w,filters:y,footerText:C,filterStatus:x,hasAlertsCrudPermissions:O,indexNames:S,itemsPerPageOptions:I,onRuleChange:k,query:F,renderCellValue:P,rowRenderers:A,setRefetch:M,start:R,sort:D,graphEventId:N,leadingControlColumns:V,trailingControlColumns:z,data:L,unit:_})=>{const q=Object(l.useDispatch)(),B=Object(c.isEmpty)(s)?f.c:s,{uiSettings:H}=Object(p.useKibana)().services,[Q,G]=Object(a.useState)(!1),[W,{browserFields:K,indexPatterns:Z}]=((e,t=!1)=>{const{data:n}=Object(p.useKibana)().services,i=Object(a.useRef)(new AbortController),l=Object(a.useRef)(new dt.Subscription),s=Object(a.useRef)([]),[r,o]=Object(a.useState)(!1),[d,u]=Object(a.useState)({browserFields:mt,docValueFields:bt,indexes:e,indexExists:!0,indexPatterns:pt}),{addError:m,addWarning:b}=Object(j.a)(),h=Object(a.useCallback)((e=>{l.current.unsubscribe(),i.current.abort(),(async()=>{i.current=new AbortController,o(!0),l.current=n.search.search({indices:e,onlyCheckIfIndicesExist:t},{abortSignal:i.current.signal,strategy:"indexFields"}).subscribe({next:e=>{if(Object(g.isCompleteResponse)(e)){const t=e.indicesExist.sort().join();s.current=e.indicesExist,o(!1),u({browserFields:gt(t,e.indexFields),docValueFields:ht(t,e.indexFields),indexes:e.indicesExist,indexExists:e.indicesExist.length>0,indexPatterns:ft(t,e.indexFields)}),l.current.unsubscribe()}else Object(g.isErrorResponse)(e)&&(o(!1),b(ct),l.current.unsubscribe())},error:e=>{o(!1),m(e,{title:ut}),l.current.unsubscribe()}})})()}),[n.search,m,b,t,o,u]);return Object(a.useEffect)((()=>(Object(c.isEmpty)(e)||Object(c.isEqual)(s.current,e)||h(e),()=>{l.current.unsubscribe(),i.current.abort()})),[e,h,s]),[r,d]})(S),J=Object(a.useMemo)((()=>r.d.getTGridByIdSelector()),[]),{itemsPerPage:Y,itemsPerPageOptions:X,queryFields:ee,sort:te,title:ne}=Object(h.a)((e=>J(e,vt)));Object(a.useEffect)((()=>{q(r.c.updateIsLoading({id:vt,isLoading:Q}))}),[q,Q]);const ae=Object(a.useMemo)((()=>i.a.createElement(yt,{"data-test-subj":"title"},ne)),[ne]),ie=Object(a.useMemo)((()=>Object(E.d)({config:g.esQuery.getEsQueryConfig(H),dataProviders:wt,indexPattern:Z,browserFields:K,filters:y,kqlQuery:F,kqlMode:"search",isEventViewer:!0})),[H,Z,K,y,F]),le=Object(a.useMemo)((()=>!W&&null!=ie&&!Object(c.isEmpty)(R)&&!Object(c.isEmpty)(m)),[W,ie,R,m]),se=Object(a.useMemo)((()=>[...B.reduce(((e,t)=>null!=t.linkField?[...e,t.id,t.linkField]:[...e,t.id]),[]),...null!=ee?ee:[]]),[B,ee]),re=Object(a.useMemo)((()=>te.map((({columnId:e,columnType:t,sortDirection:n})=>({field:e,type:t,direction:n})))),[te]),[oe,{consumers:de,events:ce,updatedAt:ue,loadPage:me,pageInfo:pe,refetch:be,totalCount:ge=0,inspect:he}]=T({docValueFields:[],entityType:v,excludeEcsData:!0,fields:se,filterQuery:null==ie?void 0:ie.filterQuery,id:vt,indexNames:S,limit:Y,sort:re,startDate:R,endDate:m,skip:!le,data:L});M(be);const{hasAlertsCrud:fe,totalSelectAllAlerts:Ee}=Object(a.useMemo)((()=>Object.entries(de).reduce(((e,[t,n])=>{const a=O({ruleConsumer:t});return{hasAlertsCrud:a||e.hasAlertsCrud,totalSelectAllAlerts:a?n+e.totalSelectAllAlerts:e.totalSelectAllAlerts}}),{hasAlertsCrud:!1,totalSelectAllAlerts:0})),[de,O]),ve=Object(a.useMemo)((()=>ge>0?ge-d.length:0),[d.length,ge]),we=ve>0,ye=Object(l.useSelector)((e=>r.d.activeCaseFlowId(e))),Ce=Object(a.useMemo)((()=>{const e=ce.find((e=>e.ecs._id===ye));return e||void 0}),[ce,ye]),xe=Object(a.useMemo)((()=>({event:Ce,casePermissions:null!=n?n:null,appId:t,onClose:e})),[t,n,e,Ce]),je=Object(a.useMemo)((()=>ce.filter((e=>!d.includes(e._id)))),[d,ce]),Oe=Object(a.useMemo)((()=>Object(E.e)({config:g.esQuery.getEsQueryConfig(H),dataProviders:wt,indexPattern:Z,browserFields:K,filters:y,kqlQuery:F,kqlMode:"search",isEventViewer:!0,from:R,to:m})),[H,Z,K,y,F,R,m]);Object(a.useEffect)((()=>{G(oe)}),[oe]),Object(a.useEffect)((()=>{q(r.c.createTGrid({id:vt,columns:s,dateRange:{start:R,end:m},indexNames:S,itemsPerPage:Y,itemsPerPageOptions:I,showCheckboxes:!0})),q(r.c.initializeTGridSettings({id:vt,defaultColumns:s,footerText:C,sort:D,loadingText:w,unit:_}))}),[]);const Ie=Object(a.useRef)(!0);Object(a.useEffect)((()=>{Ie.current&&!oe&&(Ie.current=!1)}),[oe]);const ke={timelineId:vt};return Object(a.useEffect)((()=>{q(r.c.clearSelected({id:vt})),q(r.c.setTGridSelectAll({id:vt,selectAll:!1}))}),[je,q]),i.a.createElement(Qe,{"data-test-subj":"events-viewer-panel"},i.a.createElement(Ct,null,Ie.current&&i.a.createElement(et.b,null),le?i.a.createElement(et.c.Provider,{value:ke},i.a.createElement(xt,{"data-timeline-id":vt,"data-test-subj":`events-container-loading-${oe}`},i.a.createElement($.j,{gutterSize:"s",justifyContent:"flexEnd",alignItems:"center"},i.a.createElement($.k,{grow:!1,$show:!oe},i.a.createElement(We,{title:ae,inspect:he,loading:oe})),i.a.createElement($.k,{grow:!1,$show:!oe},i.a.createElement(qt.LastUpdatedAt,{updatedAt:ue}))),!we&&!oe&&i.a.createElement(et.a,null),we&&i.a.createElement($.h,{direction:"row",$visible:!N,gutterSize:"none"},i.a.createElement(jt,{grow:1},i.a.createElement(Se,{activePage:pe.activePage,browserFields:K,data:je,defaultCellActions:o,disabledCellActions:u,filterQuery:Oe,hasAlertsCrud:fe,hasAlertsCrudPermissions:O,id:vt,indexNames:S,isEventViewer:!0,itemsPerPageOptions:X,leadingControlColumns:V,loadPage:me,refetch:be,renderCellValue:P,rowRenderers:A,onRuleChange:k,pageSize:Y,tabType:b.v.query,tableView:"gridView",totalItems:ve,totalSelectAllAlerts:Ee,unit:_,filterStatus:x,trailingControlColumns:z}))))):null,i.a.createElement(Et.AddToCaseAction,U()({},xe,{disableAlerts:!0}))))},St=i.a.memo(Ot),It=e=>{const{type:t,...n}=e;return"standalone"===t?i.a.createElement(St,n):"embedded"===t?i.a.createElement(ot,n):null};var kt=n(101),Ft=n(31),Pt=n(30),At=n(46);const Mt=[Ft.b],Rt=({browserFields:e,defaultsHeader:t,children:n})=>{const s=Object(l.useDispatch)(),r=Object(a.useCallback)((n=>{try{var a,i;if(Nt(),Object(q.l)(n))Object(Pt.a)({browserFields:e,defaultsHeader:t,dispatch:s,result:n,timelineId:Object(Pt.c)(null!==(a=null===(i=n.destination)||void 0===i?void 0:i.droppableId)&&void 0!==a?a:"")})}finally{document.body.classList.remove(q.e),Object(q.k)(n)&&document.body.classList.remove(q.f)}}),[e,t,s]);return i.a.createElement(kt.DragDropContext,{onDragEnd:r,onBeforeCapture:Dt,sensors:Mt},n)};Rt.displayName="DragDropContextWrapperComponent";const Tt=i.a.memo(Rt,((e,t)=>w()(e.children,t.children)));Tt.displayName="DragDropContextWrapper";const Dt=e=>{Object(q.k)(e)||document.body.classList.add(q.e),Object(q.k)(e)&&document.body.classList.add(q.f)},Nt=()=>window.onscroll=()=>c.noop;var Vt=n(21),zt=n(122);const Lt=m.a.div.attrs((({width:e})=>{if(e)return{style:{width:`${e}px`}}})).withConfig({displayName:"Field",componentId:"sc-1eeix84-0"})(["background-color:",";border:",";box-shadow:0 2px 2px -1px ",",0 1px 5px -2px ",";font-size:",";font-weight:",";line-height:",";padding:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>Object(zt.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>Object(zt.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.paddingSizes.xs));Lt.displayName="Field";const _t=i.a.memo((({fieldId:e,fieldWidth:t})=>i.a.createElement(Lt,{"data-test-subj":"field",width:t},e)));_t.displayName="DraggableFieldBadge";var qt=n(117),$t=n(115),Bt=n(116);const Ut={},Ht=e=>{const{store:t,storage:n,setStore:a,...o}=e;let d=t;d||"standalone"!==e.type||(d=Object(r.b)(Vt.a,n),a(d));let c=Ut;return null!=o.browserFields&&(c=o.browserFields),i.a.createElement(l.Provider,{store:d},i.a.createElement(s.I18nProvider,null,i.a.createElement(Tt,{browserFields:c,defaultsHeader:e.columns},i.a.createElement(It,o))))}}}]);