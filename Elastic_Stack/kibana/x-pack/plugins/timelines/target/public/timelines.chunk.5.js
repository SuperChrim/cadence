/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.timelines_bundle_jsonpfunction=window.timelines_bundle_jsonpfunction||[]).push([[5],{104:function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"a",(function(){return i})),s.d(t,"c",(function(){return l})),s.d(t,"d",(function(){return c})),s.d(t,"e",(function(){return o})),s.d(t,"f",(function(){return d})),s.d(t,"j",(function(){return u})),s.d(t,"h",(function(){return r})),s.d(t,"i",(function(){return m})),s.d(t,"g",(function(){return p}));var a=s(4);a.i18n.translate("xpack.timelines.cases.timeline.actions.addCase",{defaultMessage:"Add to case"});const n=a.i18n.translate("xpack.timelines.cases.timeline.actions.addNewCase",{defaultMessage:"Add to new case"}),i=a.i18n.translate("xpack.timelines.cases.timeline.actions.addExistingCase",{defaultMessage:"Add to existing case"}),l=a.i18n.translate("xpack.timelines.cases.timeline.actions.addToCaseAriaLabel",{defaultMessage:"Attach alert to case"}),c=a.i18n.translate("xpack.timelines.cases.timeline.actions.addToCaseTooltip",{defaultMessage:"Add to case"}),o=e=>a.i18n.translate("xpack.timelines.cases.timeline.actions.caseCreatedSuccessToast",{values:{title:e},defaultMessage:'An alert has been added to "{title}"'}),d=a.i18n.translate("xpack.timelines.cases.timeline.actions.caseCreatedSuccessToastText",{defaultMessage:"Alerts in this case have their status synched with the case status"}),u=a.i18n.translate("xpack.timelines.cases.timeline.actions.caseCreatedSuccessToastViewCaseLink",{defaultMessage:"View Case"}),r=a.i18n.translate("xpack.timelines.cases.timeline.actions.permissionsMessage",{defaultMessage:"You are currently missing the required permissions to attach alerts to cases. Please contact your administrator for further assistance."}),m=a.i18n.translate("xpack.timelines.cases.timeline.actions.unsupportedEventsMessage",{defaultMessage:"This event cannot be attached to a case"}),p=a.i18n.translate("xpack.timelines.cases.caseView.create",{defaultMessage:"Create new case"})},107:function(e,t,s){"use strict";s.d(t,"b",(function(){return x})),s.d(t,"a",(function(){return E}));var a=s(3),n=s(0),i=s.n(n),l=s(96),c=s(12),o=s(39),d=s(26),u=s(13),r=s(34),m=s(6),p=s.n(m),b=s(2),C=s(104);const v=p()(b.EuiText).withConfig({displayName:"EuiTextStyled",componentId:"sc-hx7f16-0"})(["",""],(({theme:e})=>{var t,s,a;return`\n    margin-bottom: ${null!==(t=null===(s=e.eui)||void 0===s||null===(a=s.paddingSizes)||void 0===a?void 0:a.s)&&void 0!==t?t:8}px;\n  `})),f=({caseId:e,syncAlerts:t,onViewCaseClick:s})=>{const a=Object(n.useCallback)((()=>s(e)),[e,s]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(v,{size:"s","data-test-subj":"toaster-content-sync-text"},C.f),i.a.createElement(b.EuiButtonEmpty,{size:"xs",flush:"left",onClick:a,"data-test-subj":"toaster-content-case-view-link"},C.j))},O=Object(n.memo)(f),g=p.a.span.withConfig({displayName:"Title",componentId:"sc-1y12jr1-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;"],3),j=e=>Object(a.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`,k=e=>`/create${j(null!=e?e:void 0)}`,x=({event:e,useInsertTimeline:t,casePermissions:s,appId:o,onClose:m})=>{var p,b,v;const f=null!==(p=null==e?void 0:e.ecs._id)&&void 0!==p?p:"",x=null!==(b=null==e?void 0:e.ecs._index)&&void 0!==b?b:"",T=Object(c.useDispatch)(),A=Object(r.a)((e=>e.timeline?e.timeline.timelineById[f]:e.timelineById[f])),h=Object(n.useMemo)((()=>!!A&&A.isAddToExistingCaseOpen),[A]),w=Object(n.useMemo)((()=>!!A&&A.isCreateNewCaseOpen),[A]),{application:{navigateToApp:M,getUrlForApp:y,navigateToUrl:I},notifications:{toasts:U}}=Object(d.useKibana)().services,[_,L]=Object(n.useState)(!1),$=Object(n.useCallback)((()=>L(!0)),[]),N=Object(n.useCallback)((()=>L(!1)),[]),R=Object(n.useMemo)((()=>{if(void 0!==e){return[...e.data].some((({field:e})=>"kibana.alert.uuid"===e))}return!1}),[e]),S=Object(n.useMemo)((()=>{var t,s;return!Object(a.isEmpty)(null==e||null===(t=e.ecs.signal)||void 0===t||null===(s=t.rule)||void 0===s?void 0:s.id)}),[e])||R,P=null!==(v=null==s?void 0:s.crud)&&void 0!==v&&v,D=!P||!S,V=Object(n.useCallback)((e=>{const t=(({id:e,search:t,subCaseId:s})=>s?`/${encodeURIComponent(e)}/sub-cases/${encodeURIComponent(s)}${j(null!=t?t:void 0)}`:`/${encodeURIComponent(e)}${j(null!=t?t:void 0)}`)({id:e}),s=y(o);I(`${s}/cases/${t}`)}),[I,o,y]),z=Object(l.useLocation)().search,B=Object(n.useMemo)((()=>z),[z]),F=Object(n.useMemo)((()=>y("cases")+k(B)),[y,B]),q=Object(n.useCallback)((async(t,s,a)=>{T(u.c.setOpenAddToNewCase({id:f,isOpen:!1}));const{ruleId:n,ruleName:i}=E(e);s&&await s({caseId:t.id,data:{type:"alert",alertId:f,index:null!=x?x:"",rule:{id:n,name:i},owner:o},updateCase:a})}),[f,x,o,T,e]),K=Object(n.useCallback)((async e=>{T(u.c.setOpenAddToExistingCase({id:f,isOpen:!1})),((e,t,s)=>{e.addSuccess({color:"success",iconType:"check",title:Object(d.toMountPoint)(i.a.createElement(g,null,C.e(t.title))),text:Object(d.toMountPoint)(i.a.createElement(O,{caseId:t.id,syncAlerts:t.settings.syncAlerts,onViewCaseClick:s}))})})(U,e,V)}),[V,U,T,f]),W=Object(n.useCallback)((async e=>(e.preventDefault(),M(o,{deepLinkId:"securitySolution"===o?"case":"cases",path:k(B)}))),[M,B,o]),Y=Object(n.useCallback)((e=>{null==e&&T(u.c.setOpenAddToNewCase({id:f,isOpen:!0})),T(u.c.setOpenAddToExistingCase({id:f,isOpen:!1}))}),[T,f]);return{addNewCaseClick:Object(n.useCallback)((()=>{N(),T(u.c.setOpenAddToNewCase({id:f,isOpen:!0})),m&&m()}),[m,N,T,f]),addExistingCaseClick:Object(n.useCallback)((()=>{N(),T(u.c.setOpenAddToExistingCase({id:f,isOpen:!0})),m&&m()}),[m,N,T,f]),onCaseClicked:Y,goToCreateCase:W,onCaseSuccess:K,attachAlertToCase:q,createCaseUrl:F,isAllCaseModalOpen:h,isDisabled:D,userCanCrud:P,isEventSupported:S,openPopover:$,closePopover:N,isPopoverOpen:_,isCreateCaseFlyoutOpen:w}};function E(e){var t,s,n,i;const l=e&&e.data.find((({field:e})=>e===o.ALERT_RULE_UUID)),c=e&&e.data.find((({field:e})=>e===o.ALERT_RULE_NAME)),d=l&&l.value&&l.value[0],u=c&&c.value&&c.value[0];return{ruleId:null!==(t=null!==(s=null!=d?d:Object(a.get)(`ecs.${o.ALERT_RULE_UUID}[0]`,e))&&void 0!==s?s:Object(a.get)("ecs.signal.rule.id[0]",e))&&void 0!==t?t:null,ruleName:null!==(n=null!==(i=null!=u?u:Object(a.get)(`ecs.${o.ALERT_RULE_NAME}[0]`,e))&&void 0!==i?i:Object(a.get)("ecs.signal.rule.name[0]",e))&&void 0!==n?n:null}}},138:function(e,t,s){"use strict";s.r(t),s.d(t,"AddToExistingCaseButton",(function(){return d}));var a=s(0),n=s.n(a),i=s(2),l=s(107),c=s(104);const o=({ariaLabel:e=c.c,event:t,useInsertTimeline:s,casePermissions:a,appId:o,onClose:d})=>{const{addExistingCaseClick:u,isDisabled:r,userCanCrud:m}=Object(l.b)({event:t,useInsertTimeline:s,casePermissions:a,appId:o,onClose:d});return n.a.createElement(n.a.Fragment,null,m&&n.a.createElement(i.EuiContextMenuItem,{"aria-label":e,"data-test-subj":"add-existing-case-menu-item",onClick:u,size:"s",disabled:r},c.a))},d=Object(a.memo)(o);t.default=d}}]);